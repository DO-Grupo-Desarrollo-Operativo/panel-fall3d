var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(l,W,V){l!=Array.prototype&&l!=Object.prototype&&(l[W]=V.value)};$jscomp.getGlobal=function(l){return"undefined"!=typeof window&&window===l?l:"undefined"!=typeof global&&null!=global?global:l};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var l=0;return function(W){return $jscomp.SYMBOL_PREFIX+(W||"")+l++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var l=$jscomp.global.Symbol.iterator;l||(l=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[l]&&$jscomp.defineProperty(Array.prototype,l,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(l){var W=0;return $jscomp.iteratorPrototype(function(){return W<l.length?{done:!1,value:l[W++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(l){$jscomp.initSymbolIterator();l={next:l};l[$jscomp.global.Symbol.iterator]=function(){return this};return l};$jscomp.iteratorFromArray=function(l,W){$jscomp.initSymbolIterator();l instanceof String&&(l+="");var V=0,Q={next:function(){if(V<l.length){var Ab=V++;return{value:W(Ab,l[Ab]),done:!1}}Q.next=function(){return{done:!0,value:void 0}};return Q.next()}};Q[Symbol.iterator]=function(){return Q};return Q};
$jscomp.polyfill=function(l,W,V,Q){if(W){V=$jscomp.global;l=l.split(".");for(Q=0;Q<l.length-1;Q++){var Ab=l[Q];Ab in V||(V[Ab]={});V=V[Ab]}l=l[l.length-1];Q=V[l];W=W(Q);W!=Q&&null!=W&&$jscomp.defineProperty(V,l,{configurable:!0,writable:!0,value:W})}};$jscomp.polyfill("Array.prototype.fill",function(l){return l?l:function(l,V,Q){var W=this.length||0;0>V&&(V=Math.max(0,W+V));if(null==Q||Q>W)Q=W;Q=Number(Q);0>Q&&(Q=Math.max(0,W+Q));for(V=Number(V||0);V<Q;V++)this[V]=l;return this}},"es6","es3");
function PEvs(l,W,V,Q,Ab,Be,Ld){var Wb,Bb,$a,qc,ea,Md,ab,Nc,Nd,Od,Pd,rc=0,Xb=0,sc,Cb=0,tc=!1,uc=function(f){ab=f.target;for(Nd=Nc=0;ab;)Nc+=ab.offsetLeft-ab.scrollLeft,Nd+=ab.offsetTop-ab.scrollTop,ab=ab.offsetParent;rc=f.pageX-Nc-document.body.scrollLeft;Xb=f.pageY-Nd-document.body.scrollTop};this.getX=function(){return rc};this.getY=function(){return Xb};var Rd=function(f){uc(f);sc=rc;Ta=Xb;G=!0;null!=bb&&(qc=(new Date).getTime());null!=Qd&&Qd(f)},Z=function(f){uc(f);G=!1;null!=Aa&&Aa(f);null!=
bb&&(ea=(new Date).getTime(),Md=ea-qc,300>Md&&bb(f))},Sd=function(f){uc(f);3>Math.abs(rc-sc)&&3>Math.abs(Xb-Ta)||(Ta=sc=-9999,G?null!=cb&&cb(f):null!=oa&&oa(f),null!=Ja&&J())};this.touchDown=function(f){$a=!0;Cb+=f.changedTouches.length;if(1<Cb)return tc=!0,f.returnValue=!0;Wb=f.changedTouches;Bb=Wb[0];Rd(Bb)};this.touchUp=function(f){$a=!0;Cb-=f.changedTouches.length;0>Cb&&(Cb=0);0==Cb&&(tc=!1);if(tc)return f.returnValue=!0;f.preventDefault();f.stopImmediatePropagation?f.stopImmediatePropagation():
f.stopPropagation();Wb=f.changedTouches;Bb=Wb[0];Z(Bb)};this.touchMove=function(f){$a=!0;if(tc)return f.returnValue=!0;f.preventDefault();f.stopImmediatePropagation?f.stopImmediatePropagation():f.stopPropagation();Wb=f.changedTouches;Bb=Wb[0];Sd(Bb)};this.mouseDown=function(f){$a||(f.preventDefault(),f.stopImmediatePropagation?f.stopImmediatePropagation():f.stopPropagation(),Rd(f))};this.clearDown=function(){G=!1};this.mouseUp=function(f){$a||(f.preventDefault(),f.stopImmediatePropagation?f.stopImmediatePropagation():
f.stopPropagation(),Z(f))};this.useWheel=function(f){l.addEventListener("wheel",this.mouseWheel,!1);Pd=f};this.mouseWheel=function(f){uc(f);var l=Math.max(-1,Math.min(1,-f.deltaY||-f.detail));f.preventDefault();f.stopImmediatePropagation?f.stopImmediatePropagation():f.stopPropagation();Pd&&Pd(l)};this.mouseClick=function(f){f.preventDefault();f.stopImmediatePropagation?f.stopImmediatePropagation():f.stopPropagation();G=!1};this.mouseMove=function(f){$a||(f.preventDefault(),f.stopImmediatePropagation?
f.stopImmediatePropagation():f.stopPropagation(),Sd(f))};this.mouseDragged=function(f){$a||(f.preventDefault(),f.stopImmediatePropagation?f.stopImmediatePropagation():f.stopPropagation(),uc(f),null!=cb&&cb(f),null!=Ja&&J())};var J=function(){clearTimeout(Od);Od=setTimeout(function(){Ja()},600)};var Ta=sc=Xb=rc=0;var Qd=W;var Aa=V;var oa=Q;var cb=Ab;var bb=Be;var Ja=Ld;var G=$a=!1;l.addEventListener("mousedown",this.mouseDown,!1);l.addEventListener("mouseup",this.mouseUp,!1);l.addEventListener("mousemove",
this.mouseMove,!1);l.addEventListener("click",this.mouseClick,!1);l.addEventListener("touchstart",this.touchDown,!1);l.addEventListener("touchend",this.touchUp,!1);l.addEventListener("touchmove",this.touchMove,!1);l.addEventListener("pointerdown",this.mouseDown,!1);l.addEventListener("pointerup",this.mouseUp,!1);l.addEventListener("pointermove",this.mouseMove,!1);l.addEventListener("contextmenu",function(f){f.preventDefault()},!1);l.addEventListener("touchleave",this.touchUp,!1);l.addEventListener("touchenter",
this.touchDown,!1);l.addEventListener("touchcancel",this.touchUp,!1);l.addEventListener("mouseout",function(f){G||(Xb=rc=-1,null!=oa&&oa(f));G=!1})};var HAniS=new function(){function l(b){var a;Oc=!0;if(b instanceof Array)for(e={},a=0;a<b.length;a++){if(!(2>b[a].length)){var d=b[a].trim();if(0!=d.indexOf("#")){var c=d.indexOf("=");if(!(1>c)){var g=d.substr(0,c).trim().toLowerCase();e[g]=d.substr(c+1).trim()}}}}else e=b;Td=!1;a=e.debug;null!=a&&("true"==a?(Ce=window.open("","HAniSDebugInfo","scrollbars=yes,width=400,height=200"),Td=!0,ca("HAniS Version 4.11g")):Td=!1);N=!0;a=e.set_className;null!=a&&M(a,"f")&&(N=!1);ca("Is type of param an array = "+
(b instanceof Array));a=e.divalign;null!=a&&(gd=a.trim(),F.align=gd);a=e.initial_message;null!=a&&(b=e.initial_message_style,null==b&&(b="background-color:red;top:10px;left:10px;height:100px;width:200px"),b="z-index:99;position:absolute;"+b,Yb=n("div"),Yb.setAttribute("style",b),Yb.innerHTML=a,Yb.addEventListener("click",function(){Yb.style.visibility="hidden"},!1),Yb.style.visibility="visible",Ka.appendChild(Yb),b=e.initial_message_timeout,null!=b&&("auto"==b?De=!0:(De=!1,b=parseInt(e.initial_message_timeout,
10),2>b&&(b=2),setTimeout(function(){Yb.style.visibility="hidden"},1E3*b))));a=e.coordinates;null!=a&&Q(a);d="green";c="white";g="12px Arial";var X=null,h=10,k=10,f=10;Ee=2;Af="Lat = ";Bf=" Lon = ";a=e.coordinates_display_style;null!=a&&(b=a.split(","),d=b[0].trim(),c=b[1].trim(),g=b[2].trim(),3<b.length&&(Af=b[3],Bf=b[4],Ee=parseInt(b[5],10),6<b.length&&(X=b[6].trim(),h=parseInt(b[7],10),k=parseInt(b[8],10),f=parseInt(b[9],10))));Cf=new bb(d,c,g,X,h,k,f);Ud=vc=null;null!=e.map_scale&&(Vd=Zb=!0,b=
e.map_scale.split(","),vc=parseFloat(b[0]),Ud=1<b.length?parseFloat(b[1]):vc);Df=" ";a=e.distance_unit;null!=a&&(Df=a.trim());a=e.divcan_style;null!=a&&a.trim();a=e.imagecan_style;null!=a&&(b=a.trim()+";position:absolute;top:0;left:0;",sb.setAttribute("style",b+"z-index:1;"),$b.setAttribute("style",b+"z-index:6;"));d="blue";c="white";g="12px Arial";X=null;f=k=h=10;Ef=1;Ff="white";a=e.distance_display_style;null!=a&&(b=a.split(","),d=b[0].trim(),c=b[1].trim(),Ff=5<=b.length?b[4].trim():c,g=b[2].trim(),
Ef=parseInt(b[3],10),5<b.length&&(X=b[5].trim(),h=parseInt(b[6],10),k=parseInt(b[7],10),f=parseInt(b[8],10)));ah=new bb(d,c,g,X,h,k,f);d="black";c="white";g="12px Arial";X=null;f=k=h=10;a=e.probe_display_style;null!=a&&(b=a.split(","),d=b[0].trim(),c=b[1].trim(),g=b[2].trim(),3<b.length&&(X=b[3].trim(),h=parseInt(b[4],10),k=parseInt(b[5],10),f=parseInt(b[6],10)));bh=new bb(d,c,g,X,h,k,f);Gf="Undefined";Hf=!1;hd=0;a=e.probe_undefined;null!=a&&(b=a.split(","),Gf=b[0].trim(),1<b.length&&(hd=parseInt(b[1],
10)+1),2<b.length&&(Hf=!0));Fe=!1;e.probe_base_image&&(Fe=!0);a=e.active_probe;null!=a&&(ac=Wd=!0);a=e.pause;null!=a&&(If=parseInt(a,10));a=e.auto_refresh;null!=a&&(Ge=6E4*parseInt(a,10),wc=setInterval("HAniS.reloadFOF();",Ge),id=!0);jd=!1;a=e.enable_smoothing;null!=a&&M(a,"t")&&(jd=!0);Xd=!0;a=e.check_image_size;null!=a&&M(a,"f")&&(Xd=!1);Jf=!1;a=e.sprites;if(null!=a){b=a.split(",");He=new Image;Ie=[];Je=[];Db=[];Eb=[];if("row"==b[1].trim().toLowerCase())for(k=c=d=0,a=2;a<b.length;)for("row"==b[a].trim().toLowerCase()&&
(d=0,c+=k,k=0,a+=1),h=parseInt(b[a],10),a+=1,g=parseInt(b[a],10),a+=1,X=parseInt(b[a],10),X>k&&(k=X),a+=1,f=0;f<h;f++)Ie.push(d),Je.push(c),Db.push(g),Eb.push(X),d+=g;else for(c=!1,a=1;a<b.length;)Ie.push(parseInt(b[a],10)),a+=1,Je.push(parseInt(b[a],10)),a+=1,a>=b.length?(d=0,c=!0):d=parseInt(b[a],10),0>d?(c=!0,Db.push(Math.abs(d)),a+=1,d=parseInt(b[a++],10),Eb.push(Math.abs(d))):c?(Db.push(Db[Db.length-1]),Eb.push(Eb[Eb.length-1])):(Db.push(parseInt(b[a],10)),a+=1,Eb.push(parseInt(b[a],10)),a+=
1);He.onload=function(){Jf=!0};He.src=b[0]}a=e.overlay_labels;null!=a&&(Fb=a.split(","));Ke=null;a=e.auto_enhance_background;null!=a&&(Ke=parseInt(a,10)-1);xc=null;a=e.auto_enhance;if(null!=a)for(d=e.overlay_probe_table,b=a.split(","),xc=Array(b.length),a=0;a<b.length;a++)"x"==b[a].trim().toLowerCase()?xc[a]=-1:xc[a]=parseInt(b[a].trim(),10)-1,null==d&&(bc[a]=xc[a]);yc=!1;db=-1;a=e.overlay_enhance;null!=a&&(yc=!0,db=parseInt(a,10)-1);cc=null;Pc=!0;a=e.overlay_allow_hoverzones;if(null!=a)for(b=a.split(","),
cc=Array(b.length),a=0;a<b.length;a++)if(cc[a]=!0,M(b[a],"n")||M(b[a],"f"))cc[a]=!1;R=U=null;Le=Kf=!1;a=e.window_size;null!=a&&(b=a.split(","),"div"==b[0]?Le=!0:(R=parseInt(b[0],10),U=parseInt(b[1],10)),Kf=!0);kd=[];a=e.use_for_all_frames;if(null!=a)for(b=a.split(","),a=0;a<b.length;a+=2)kd[parseInt(b[a],10)]=parseInt(b[a+1],10)-1;ld=-1;a=e.skip_missing;null!=a&&(ld=parseInt(a,10));Lf="#00000000";a=e.skip_missing_color;null!=a&&(Lf=a);Yd=null;a=e.overlay_spacer;if(null!=a)for(b=a.split(","),Yd=Array(b.length),
a=0;a<b.length;a++)Yd[a]=parseInt(b[a],10);a=e.overlay_probe_table;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)"x"==b[a].trim().toLowerCase()?bc[a]=-1:bc[a]=parseInt(b[a],10)-1;Me=[];a=e.overlay_ontop;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)Me[parseInt(b[a],10)-1]=!0;zc=null;a=e.overlay_order;null==a&&(a=e.overlay_zorder);if(null!=a)for(b=a.split(","),zc=Array(b.length),a=0;a<b.length;a++)zc[parseInt(b[a],10)-1]=a;Gb=null;a=e.overlay_links;if(null!=a)for(b=a.split(","),Gb=Array(b.length),
a=0;a<b.length;a++)Gb[a]=parseInt(b[a],10);Mf=[];Ba=null;a=e.overlay_slice;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)Mf[parseInt(b[a],10)-1]=!0;Nf=!0;a=e.slice_smoothing;M(a,"f")&&(Nf=!1);Qc=null;a=e.overlay_clear;if(null!=a)for(b=a.split(","),Qc=Array(b.length),a=0;a<b.length;a++)Qc[a]=b[a].trim().toLowerCase();Of=!1;a=e.transparency;null!=a&&(b=a.split(","),1==b.length?Pf=Qf=Rf=parseInt(b[0],10):(Pf=parseInt(b[0],10),Qf=parseInt(b[1],10),Rf=parseInt(b[2],10)),Of=!0);Ne=!1;a=e.transparency_list;
if(null!=a){b=a.split(",");Sf=[];for(a=0;a<b.length;a++)Sf[parseInt(b[a].trim(),10)-1]=!0;Ne=!0}Zd=null;a=e.overlay_transparent_amount;if(null!=a)for(b=a.split(","),Zd=Array(b.length),a=0;a<b.length;a++)Zd[a]=parseFloat(b[a])/100;Ac=null;a=e.overlay_zoom;if(null!=Fb&&null!=a)for(b=a.split(","),Ac=Array(b.length),a=0;a<b.length;a++)if(Ac[a]=1,M(b[a],"n")||M(b[a],"f"))Ac[a]=0;else if(M(b[a],"d")||M(b[a],"h"))Ac[a]=-1;eb=null;Tf=[];a=e.overlay_preserve_list;if(null!=Fb&&null!=a)for(b=a.split(","),eb=
Array(b.length),a=0;a<b.length;a++){eb[a]=!0;if(M(b[a],"n")||M(b[a],"f"))eb[a]=!1;if(M(b[a],"a")||M(b[a],"A"))Tf[a]=!0}aa=null;if(null!=Fb&&null!=eb)for(b=e.overlay_preserve.split(","),d=e.overlay_preserve_position,null!=d&&(d=d.split(",")),aa=Array(eb.length),a=g=0;a<eb.length;a++)if(eb[a]){aa[a]=Array(6);for(c=0;4>c;c++)aa[a][c]=parseInt(b[g].trim(),10),g+=1;aa[a][2]=aa[a][2]-aa[a][0]+1;aa[a][3]=aa[a][3]-aa[a][1]+1;null!=d?(aa[a][4]=parseInt(d[g/2-2],10),aa[a][5]=parseInt(d[g/2-1],10)):(aa[a][4]=
aa[a][0],aa[a][5]=aa[a][1])}$d=0;Uf=" ";dc="white";md="transparent";nd="14pt arial";Vf=!1;a=e.times_label_style;null!=a&&(b=a.split(","),dc=b[0].trim(),1<b.length&&($d=Math.floor(60*parseFloat(b[1]))),1<b.length&&($d="?"==b[1].trim()||"auto"==b[1].trim().toLowerCase()?-Math.floor((new Date).getTimezoneOffset()):Math.floor(60*parseFloat(b[1]))),2<b.length&&(Uf=b[2].trim()),3<b.length&&(md=b[3].trim()),4<b.length&&(nd=b[4].trim()),5<b.length&&-1!=b[5].trim().indexOf("t")&&(Vf=!0));0==dc.indexOf("0x")&&
(dc="#"+dc.substring(2));0==md.indexOf("0x")&&(md="#"+md.substring(2));Rc=parseInt(nd,10);ch=new bb("black","white",nd,"black",20,5,5);Wf=!1;a=e.to_from_lock;null!=a&&(Wf=M(a,"t")?!0:!1);a="black";h="white";k="14px arial";d=null;X=g=c=10;Xf=Yf=" ";Oe=Sc=null;a=e.dirspd_display_style;null!=a&&(b=a.split(","),a=b[0].trim(),h=b[1].trim(),k=b[2].trim(),Xf=b[3],Yf=b[4],5<b.length&&(d=b[5].trim(),c=parseInt(b[6],10),g=parseInt(b[7],10),X=parseInt(b[8],10)),Oe=new bb(a,h,k,d,c,g,X));d="black";c="white";
g="14px arial";X=null;f=k=h=10;a=e.tipbox_display_style;null!=a&&(b=a.split(","),d=b[0].trim(),c=b[1].trim(),g=b[2].trim(),3<b.length&&(X=b[3].trim(),h=parseInt(b[4],10),k=parseInt(b[5],10),f=parseInt(b[6],10)));Zf=new bb(d,c,g,X,h,k,f);ae=null;ba=e.image_base;null!=ba?ae=ba=ba.trim():ba=null!=e.image_only_base?e.image_only_base.trim():null;$f=ba;a=e.overlay_base;null!=a&&(ec=a.trim());Oc=!0;a=e.filenames;null!=a&&dh(a);a=e.basename;null!=a&&(d=e.base_starting_number,c=0,g=1,null!=d&&(b=d.split(","),
c=parseInt(b[0],10),1<b.length&&(g=parseInt(b[1],10))),v=e.num_frames,null==v&&(v=e.num_images),v=parseInt(v,10),eh(a,c,g));Pe=!0;b=e.background_static;null!=b&&(M(b,"f")||M(b,"n"))&&(Pe=!1);a=e.overlay_filenames;if(null!=a){b=a.split(",");pa=Array(v);for(a=0;a<b.length;a++)for(d=b[a].split("&"),fa=b.length,c=0;c<v;c++)0===a&&(pa[c]=Array(fa)),pa[c][a]=d[c].trim(),null!=ec?pa[c][a]=(ec+pa[c][a]).trim():null!=ba&&(pa[c][a]=(ba+pa[c][a]).trim());Oc=!1}wa=null;a=e.image_preserve;if(null!=a)for(b=a.split(","),
wa=[],a=0;a<b.length;a++)wa[a]=parseInt(b[a].trim(),10),1<a%4&&(wa[a]=wa[a]-wa[a-2]+1);ag=!0;a=e.keep_zoom;null!=a&&M(a,"f")&&(ag=!1);Tc=bg=0;a=e.hide_bottom;null!=a&&(bg=parseInt(a.trim(),10));be=cg=0;a=e.hide_top;null!=a&&(cg=parseInt(a.trim(),10));dg="<div>";eg=300;fg=500;a=e.popup_style;null!=a&&(dg='<div style="'+a+'">');a=e.popup_window_size;null!=a&&(b=a.split(","),fg=b[0],eg=b[1]);gg=ra=!1;a=e.active_zoom;null!=a&&M(a,"t")&&(ra=!0,ma.useWheel(HAniS.wheel));hg=!1;a=e.cycle_zoom;null!=a&&M(a,
"t")&&(hg=!0);a=e.initial_zoom;null!=a&&(b=a.split(","),fc="auto"!=b[0].toLowerCase()?parseFloat(b[0]):"auto",1<b.length?(od=parseInt(b[1],10),ig=parseInt(b[2],10)):od=-1,jg=!0);pd=1;a=e.zoom_scale;null!=a&&(pd=parseFloat(a));Bc=9999999;a=e.maximum_zoom;null!=a&&(Bc=parseFloat(a));Qe=!0;a=e.use_progress_bar;null!=a&&M(a,"f")&&(Qe=!1);a=e.dwell;null!=a&&(b=a.split(","),Ua=parseInt(b[0].trim(),10),1<b.length&&(Hb=parseInt(b[1].trim(),10),10>Hb&&(Hb=10),Cc=parseInt(b[2].trim(),10),Re=parseInt(b[3].trim(),
10)));a=e.rate;null!=a&&(b=a.split(","),Ua=Math.round(1E4/parseFloat(b[0].trim())),1<b.length&&(Hb=Math.round(1E4/parseFloat(b[2].trim())),10>Hb&&(Hb=10),Cc=Math.round(1E4/parseFloat(b[1].trim()))));a=e.frame_times_template;null!=a&&(b=a.split(","));fb=null;a=e.times;if(null!=a){b=a.split(",");fb=Array(b.length);for(a=0;a<b.length;a++)fb[a]=parseInt(b[a].trim(),10);Ld(fb)}a=e.extrap_times_filename;if(null!=a){fb=[];var O=new XMLHttpRequest;O.open("get",a,!0);O.onload=function(){for(var a=O.responseText.split("\n"),
b=0;b<a.length;b++){var c=a[b].split(" ");if(3==c.length){c[2].trim();var d=parseInt(c[0],10)-1;fb[d]=100*parseInt(c[2].substring(0,2),10)+parseInt(c[2].substring(3,5),10)+parseInt(c[2].substring(6,8),10)/30}}Ld(fb)};O.send()}qd=null;a=e.extrap_times_template;null!=a&&(qd=RegExp(a));kg=["Click on target's initial position","Click on target's final position","Move pointer around or click here to select target"];lg=10;a=e.extrap_prompts_position;null!=a&&M(a,"bot")&&(lg=9999);a=e.extrap_prompts;null!=
a&&(kg=a.split(","));ce=["Click on first point to mark","Save points","Remove last point"];a=e.mark_prompts;null!=a&&(ce=a.split(","));Se="12pt Arial";mg="white";a=e.mark_prompts_style;null!=a&&(b=a.split(","),Se=b[0].trim(),1<b.length&&(mg=b[1].trim()));ng=e.controls;ca("controls = "+e.controls);ca("bottom_controls = "+e.bottom_controls);gc=rd=Ib=Jb=Va=Wa=gb=null;null!=ng&&Md(ng,!0);og=e.bottom_controls;null!=og&&Md(og,!1);a=e.probe_table;if(null!=a){b=new XMLHttpRequest;hb=[];de=[];Dc=[];var sd=
" ";Ec=[];var m="Value=";Kb=[];var l=1;Fc=[];Te=[];La=[];Ma=[];Na=[];var r,z=-1;q=-1;var x=0;b.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var c=a[b].replace(/\s+/g," ").trim().split(","),d=c[0].split(" ");if(0==d[0].indexOf("*"))q++,hb[q]=[],Ec[q]=[],Dc[q]=[],Kb[q]=[],La[q]=[],Ma[q]=[],Na[q]=[],Te[q]=[],Fc[q]=[],z=-1,de[q]=1<c.length?c[1].trim():"None",x=1;else if(0!=x){z++;var g=Array(3);hb[q][z]=parseFloat(d[0]);La[q][z]=parseInt(d[1].trim(),
10);Ma[q][z]=parseInt(d[2].trim(),10);Na[q][z]=parseInt(d[3].trim(),10);0!=z&&(g[0]=La[q][z]-La[q][z-1],g[1]=Ma[q][z]-Ma[q][z-1],g[2]=Na[q][z]-Na[q][z-1],r=0,Math.abs(g[1])>Math.abs(g[r])&&(r=1),Math.abs(g[2])>Math.abs(g[r])&&(r=2),Te[q][z-1]=r,Fc[q][z-1]=g,0==Fc[q][z-1][r]&&(Fc[q][z-1][r]=1));1<c.length&&(0==c[1].trim().indexOf('"')?(l=-1,c=c[1].trim(),m=c.substr(1,c.length-2),sd=""):(l=parseInt(c[1],10),2<c.length&&(sd=fh(c[2].trim())),3<c.length&&(m=c[3].trim())));Ec[q][z]=m;Kb[q][z]=l;Dc[q][z]=
sd}}};b.open("get",a,!0);b.send()}b=e.enhance_filename;null==b&&(b=e.enhance_table);if(null!=b){ca("Reading enhancement table...");O=new XMLHttpRequest;hb=[];Dc=[];de=[];Ec=[];Kb=[];La=[];Ma=[];Na=[];td=[];q=-1;pg=!0;var p=!1,t,w,u,Ue,E,y,H,A,C,D,I,G,J;O.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var c=a[b].replace(/\s+/g," ").trim(),d=c.indexOf("#");if(0!=d)if(0<d&&(c=c.substring(0,d)),d=c.split(","),0==d[0].indexOf("*"))q++,hb[q]=Array(256),
Ec[q]=Array(256),Dc[q]=Array(256),Kb[q]=Array(256),La[q]=Array(256),Ma[q]=Array(256),Na[q]=Array(256),td[q]=Array(256),hb[q]=Array(256),de[q]=1<d.length?d[1].trim():"None",sd=" ",m="Value =",l=1,c=n("option"),c.innerHTML=d[0].substring(1),c.value=q,null!=sa&&sa.add(c);else{var g=c.indexOf("value");0>g&&(g=c.indexOf("probe"));p=!1;D=I=0;0<g&&(d=c.substring(g+1),c=c.substring(0,g),g=d.indexOf("="),d=d.substring(g+1),d=d.split(","),1==d.length?(m=d[0].trim(),l=-1,p=!1):(D=parseFloat(d[0].trim()),I=parseFloat(d[1].trim()),
2<d.length&&(l=parseInt(d[2],10)),3<d.length&&(sd=fh(d[3].trim())),4<d.length&&(m=d[4].trim()),p=!0));c=c.split(" ");t=parseInt(c[0].trim(),10);w=parseInt(c[1].trim(),10);u=w-t;Ue=parseFloat(c[2].trim());E=parseFloat(c[3].trim());y=parseFloat(c[4].trim());H=parseFloat(c[5].trim());A=parseFloat(c[6].trim());C=parseFloat(c[7].trim());G=J=255;9<c.length&&(G=parseFloat(c[8].trim()),J=parseFloat(c[9].trim()));for(c=t;c<=w;c++)0===u?(La[q][t]=Ue,Ma[q][t]=y,Na[q][t]=A,td[q][t]=G):(La[q][c]=Math.round(Ue+
(E-Ue)*(c-t)/u),Ma[q][c]=Math.round(y+(H-y)*(c-t)/u),Na[q][c]=Math.round(A+(C-A)*(c-t)/u),td[q][c]=Math.round(G+(J-G)*(c-t)/u)),Ec[q][c]=m,Dc[q][c]=sd,Kb[q][c]=l,p&&(hb[q][c]=D+(I-D)*(c-t)/u)}}-1!=db&&B[db].checked&&(sa.disabled=!1);W()};O.open("get",b,!0);O.send()}else W()}function W(){var b=e.sprite_filenames;if(null!=b){var a=b.split(",");Ve=0;da=[];b=e.sprite_images_offset;Gc=-1;null!=b&&(Gc=parseInt(b,10)-1);for(b=0;b<a.length;b++){da[b]=new Image;da[b].gotit=!1;da[b].inx=b;da[b].fromfile=!0;
da[b].zoomme=0<a[b].indexOf("/zoom");da[b].anim=0<a[b].indexOf("/animate");var d=a[b].indexOf("/");0<d&&(a[b]=a[b].substring(0,d));da[b].onload=function(){da[this.inx].gotit=!0;Ve++;Ve==a.length&&V()};da[b].src=a[b].trim()}}else V()}function V(){for(var b=Object.keys(e),a=0;a<b.length;a++)M(b[a],"hotspot")&&Nc("hotspot="+e[b[a]]);Oc?HAniS.getFOF():(Hc=!0,qc())}function Q(b){b=b.split(",");var a=b[0].trim();"PS"===a?(Lb=new wh,Lb.init(b)):"CE"==a?(Lb=new xh,Lb.init(b)):"LCC"==a?(Lb=new yh,Lb.init(b)):
(Lb=null,We=parseFloat(b[0]),qg=parseFloat(b[1]),gh=parseFloat(b[2]),hh=parseFloat(b[3]))}function Ab(b){var a=new XMLHttpRequest;a.onload=function(){l(this.responseText.split("\n"))};a.open("get",b+"?"+Math.round(1E5*Math.random()),!0);a.send()}function Be(b){var a;if(null!=Qc){for(a=0;a<Qc.length;a++)-1!=Qc[a].indexOf(b)&&(B[a].checked=!1);for(a=0;a<Qc.length;a++)ab(a)}}function Ld(b){Xe=Array(b.length);for(var a=0;a<b.length;a++){var d=60*Math.floor(b[a]/100)+Math.floor(b[a])%100;0===a&&(Mb=d);
var c=d-Mb;0>c&&(c=d+1440-Mb);Xe[a]=c;ca("times s="+d+"  min="+Xe[a])}Mb+=$d;1440<=Mb&&(Mb-=1440);0>Mb&&(Mb+=1440);ca("Starting minute = "+Mb)}function Wb(b,a){if(0!=b)for(var d=0;d<b;d++)0==B[xa[d].overlay].isGhost&&(B[xa[d].overlay].parentNode.style.visibility=a)}function Bb(){0!=ib?Wb(ib,"visible"):0!=rg&&Wb(rg,"hidden");Hc=!0;qc()}function $a(b,a){Uc||(sb.height=a,sb.width=b,$b.height=a,$b.width=b,ud.height=a,ud.width=b,ee.height=a,ee.width=b,vd=ee.getContext("2d"),R=b,U=a,fe=R/2-100,ge=U/2-10,
t=1*ha/R,w=1*Y/U,sg&&(sg=!1,null!=tg&&tg()),Ka.style.height=U+"px",Ka.style.width=R+"px",hc.style.height=U+"px",hc.style.width=R+"px",Vc.style.height=U+"px",Vc.style.width=R+"px",Qd(v,!1))}function qc(){var b,a,d,c="?"+Math.round(1E4*Math.random());ya=Array(v);ic=Xa=0;ug=Qe;Ye&&(jb.max=v);Uc&&(Wc||yc)&&(Nb=[],Ca=[],Ic=[],Ze=[],he=[]);null!=sa&&(sa.selectedIndex=0);for(b=0;b<v;b++){Uc&&(Wc||yc)&&(Nb[b]=n("canvas"),Ca[b]=n("canvas"));ya[b]=new Image;ya[b].gotit=!1;ya[b].frameNum=b;ya[b].onerror=function(){Xa++};
ya[b].onload=function(){Uc&&(Y=this.height,ha=this.width,za=Y,Oa=ha,Uc=!1,Kf?Le?HAniS.setWindowSize(F.offsetWidth,F.offsetHeight):$a(R,U):$a(ha,Y),jg&&("auto"==fc&&(fc=(t+w)/2,od=-1),za/=fc,Oa/=fc,0>od&&(od=ha/2,ig=Y/2),C=Math.round(od-ha/2/fc),y=Math.round(ig-Y/2/fc),D=L=fc,1!=fc&&(ra=!1,HAniS.toggleZooming())));if(0<ie&&!Xc){$e.height=Y;$e.width=ha;wd=$e.getContext("2d");wd.clearRect(0,0,R,U);for(var b=0;b<Da.length;b++){for(var g=Da[b].ctx.getImageData(0,0,Da[b].width,Da[b].height).data,e=wd.getImageData(Da[b].xmin,
Da[b].ymin,Da[b].width,Da[b].height),f=3;f<g.length;f+=4)0!=g[f]&&(e.data[f]=b+1);wd.putImageData(e,Da[b].xmin,Da[b].ymin)}ra||(Ya=!0);1==D&&(Ya=!0);Xc=!0}if(Hc){Hc=!1;H=sb.getContext("2d");H.imageSmoothingEnabled=jd;H.fillStyle="blue";H.font="bold 20px Arial";h=$b.getContext("2d");h.imageSmoothingEnabled=jd;Ea=Array(v);Qd(v,!0);Aa(oa(x));if(0<fa)for(A=Array(v),d=0;d<v;d++)for(A[d]=Array(fa),a=0;a<fa;a++)A[d][a]=new Image,A[d][a].gotit=!1,A[d][a].frameNum=d,A[d][a].overlayNum=a,A[d][a].onerror=function(){Xa++},
A[d][a].onload=function(){this.gotit=!0;var a=this.frameNum;Xa++;je();!Xd||this.height==Y&&this.width==ha?this.overlayNum==ld-1&&(Ea[this.frameNum]=0):(this.gotit=!1,ca("Bad image size:"+this.src));if(yc&&this.gotit&&this.overlayNum==db)Nb[a].height=this.height,Nb[a].width=this.width,xd=Nb[a].getContext("2d"),xd.drawImage(this,0,0),Ze[a]=xd.getImageData(0,0,this.width,this.height).data,Ca[a].height=this.height,Ca[a].width=this.width,Ic[a]=Ca[a].getContext("2d"),Ic[a].drawImage(this,0,0),he[a]=Ic[a].getImageData(0,
0,this.width,this.height),A[a][this.overlayNum]=null,A[a][this.overlayNum]=Ca[a],A[a][this.overlayNum].gotit=!0;else if(this.gotit&&B[this.overlayNum].hotspotIndex){var b=n("canvas");b.height=this.height;b.width=this.width;var c=b.getContext("2d");c.drawImage(this,0,0);var d=c.getImageData(0,0,this.width,this.height).data,g=d.length;var e=this.overlayNum;var k;for(k=0;k<g;k+=4)if(0!=d[k]){var h=d[k];var X=Math.floor(k/4/b.width);c=Math.floor(k/4%b.width);kb[lb]=new Xb(c,X,"spritefn",h,"pan",null,
null,e,a,null);lb++}}else if(this.gotit&&Of&&(!Ne||Ne&&Sf[this.overlayNum])){b=n("canvas");b.height=this.height;b.width=this.width;c=b.getContext("2d");c.drawImage(this,0,0);X=c.getImageData(0,0,this.width,this.height);d=X.data;g=d.length;for(k=0;k<g;k+=4)d[k]===Pf&&d[k+1]===Qf&&d[k+2]===Rf&&(d[k+3]=0);c.putImageData(X,0,0);A[a][this.overlayNum]=null;A[a][this.overlayNum]=b;A[a][this.overlayNum].gotit=!0}this.gotit&&Me[this.overlayNum]?(af.clearRect(0,0,R,U),af.drawImage(A[a][this.overlayNum],0,0,
R,U)):this.gotit&&Mf[this.overlayNum]&&null!=Ba&&(b=n("canvas"),b.height=Y,b.width=ha,c=b.getContext("2d"),c.imageSmoothingEnabled=Nf,c.drawImage(this,Ba[0],Ba[1],Ba[2],Ba[3],0,0,ha,Y),A[a][this.overlayNum]=null,A[a][this.overlayNum]=b,A[a][this.overlayNum].gotit=!0,null!=eb&&eb[this.overlayNum]&&(A[a][this.overlayNum].origImage=this))},b=pa[d][a],void 0!=kd[a+1]&&(b=kd[a+1],b>=v&&(b=v-1),b=pa[b][a]),void 0==yd||yd[a]||(b+=c),A[d][a].src=b,ic++;if(null!=jc)for(Ob=[],a=0;a<jc.length;a++)Ob[a]=new Image,
Ob[a].gotit=!1,Ob[a].onerror=function(a){Xa++},Ob[a].onload=function(a){a.currentTarget.gotit=!0;Xa++;je()},Ob[a].src=jc[a],ic++;if(null!=kc)for(Pb=[],a=0;a<jc.length;a++)Pb[a]=new Image,Pb[a].gotit=!1,Pb[a].onerror=function(a){Xa++},Pb[a].onload=function(a){a.currentTarget.gotit=!0;Xa++;je()},Pb[a].src=kc[a],ic++}!Xd&&0!=this.height&&0!=this.width||this.height==Y&&this.width==ha?(this.gotit=!0,0==ld&&(Ea[this.frameNum]=0)):(this.gotit=!1,ca("Image has invalid size:"+this.src));Wc&&this.gotit&&(b=
this.frameNum,Nb[b].height=this.height,Nb[b].width=this.width,xd=Nb[b].getContext("2d"),xd.drawImage(this,0,0),Ze[b]=xd.getImageData(0,0,this.width,this.height).data,Ca[b].height=this.height,Ca[b].width=this.width,Ic[b]=Ca[b].getContext("2d"),Ic[b].drawImage(this,0,0),he[b]=Ic[b].getImageData(0,0,this.width,this.height),ya[b]=null,ya[b]=Ca[b],ya[b].gotit=!0);Xa++;je();ag||HAniS.resetZoom();zd=!0;ih||(ih=!0,Fa=!1,jh());Z(mb)};var g=ta[b];void 0!=kd[0]&&(g=kd[0],g>=v&&(g=v-1),g=ta[g]);Pe||(g+=c);ya[b].src=
g;ic++}Jc=tb=!1;G()}function ea(b,a,d,c,g){b.label_on=d;b.label_off=c;d=null;c=e[a+"_labels"];null==c&&(c=e[a+"_label"]);null!=c&&(c=c.split(","),b.label_on=c[0].trim(),1<c.length&&(b.label_off=c[1].trim()),2<c.length&&(d="width:"+c[2].trim()+"px;"));null!=g&&(b.title=g);b.innerHTML=b.label_on;g=a=c=e[a+"_style"];null!=c&&(c=c.split("&"),1<c.length&&(a=c[0],g=c[1]));b.style_on=(null!=d?d:"")+lc+a;b.style_off=(null!=d?d:"")+lc+g;null!=b.style_on&&1<b.style_on.length?b.setAttribute("style",b.style_on):
(b.style_on=null,b.style_off=null)}function Md(b,a){lc=e.buttons_style;null==lc&&(lc="");var d=null,c=null;d=a?e.controls_tooltip:e.bottom_controls_tooltip;var g=b.split(",");if(null!=d){var h=d.split(",");h.length!=g.length&&(ca("!!! Number of tooltips must equal number of controls!"),h=d=null)}for(b=0;b<g.length;b++){var f=null!=d?h[b]:null;var k=g[b].trim();c=k.indexOf("/");if(0===c||0===b){0===c&&(k=k.substring(1));E=n("div");E.align=gd;var l=e.controls_style;null!=l?E.setAttribute("style",l):
E.setAttribute("style","position:relative;padding:2px;width:100%;");a?(F.insertBefore(E,Ka),bf=E):(l=e.bottom_controls_style,null!=l&&E.setAttribute("style",l),F.appendChild(E),cf=E)}"enhance"==k.trim()&&(sa=n("select"),c=e.enhance_style,null!=c&&sa.setAttribute("style",c),null!=f&&(sa.title=f),c=n("option"),c.innerHTML="Pick Enhancement",c.value=-1,sa.add(c),sa.addEventListener("change",HAniS.doEnhance,!1),Wc=!yc,sa.disabled=Wc?!1:!0,E.appendChild(sa));"startstop"==k&&(gb=n("button"),N&&(gb.className=
"startstop start"),ea(gb,"startstop","Animar","Stop",f),gb.addEventListener("click",HAniS.toggleIsLooping,!1),E.appendChild(gb));"looprock"==k&&(Yc=n("button"),N&&(Yc.className="looprock rock"),ea(Yc,"looprock","Rock","Loop",f),df=1,Yc.addEventListener("click",HAniS.toggleLoopRock,!1),E.appendChild(Yc));"extrap"==k&&(ub=n("button"),N&&(ub.className="extrap"),ea(ub,"extrap","Enable Extrap","Disable Extrap",f),ub.addEventListener("click",HAniS.toggleExtrap,!1),E.appendChild(ub));M(k,"location")&&(Kc=
n("button"),N&&(Kc.className="location"),ea(Kc,"location","Show Loc","Hide Loc",f),0<k.indexOf("/on")?(J(Kc,!1,"location off"),Zc=!0):Zc=!1,Kc.addEventListener("click",function(){(Zc=!Zc)?J(Kc,!1,"location off"):J(Kc,!0,"location on")},!1),E.appendChild(Kc));"distance"==k&&(vb=n("button"),N&&(vb.className="distance"),ea(vb,"distance","Show dist","Hide dist",f),Zb=Vd=!1,vb.addEventListener("click",function(){(Zb=!Zb)?J(vb,!1,"distance off"):J(vb,!0,"distance on")},!1),E.appendChild(vb));"probe"==k&&
($c=n("button"),N&&($c.className="probe"),ea($c,"probe","Show probe","Hide probe",f),ac=Wd=!1,$c.addEventListener("click",function(){(Wd=!Wd)?(J($c,!1,"probe off"),ac=!0):(J($c,!0,"probe on"),ac=!1)},!1),E.appendChild($c));"mark"==k&&(mc=n("button"),N&&(mc.className="mark"),ea(mc,"mark","Mark","Stop Mark",f),Ad=!0,mc.addEventListener("click",function(){nb=!nb;ia=[];nb?(ad=0,J(mc,!1,"mark off"),null!=ua&&(ua.disabled=!0)):(J(mc,!0,"mark on"),null!=ua&&(ua.disabled=!1),ad=-1);G()},!1),kh=new bb("black",
"white",Se,"black",20,5,5),vg=new bb("black","white",Se,"black",20,5,5),E.appendChild(mc));"refresh"==k&&(rd=n("button"),N&&(rd.className="refresh"),ea(rd,"refresh","Refresh",null,f),rd.addEventListener("click",HAniS.reloadFOF,!1),E.appendChild(rd));"setframe"==k&&(jb=n("input"),N&&(jb.className="setframe"),jb.type="range",jb.min=1,jb.max=100,jb.value=1,ke="Frame #*",l=e.setframe_label,null!=l&&(ke=l),Bd=n("span"),Bd.innerHTML=ke.replace("*",1),c="display:block;vertical-align:middle;"+e.setframe_style,
jb.setAttribute("style",c),c=n("span"),c.setAttribute("style","display:inline-block;vertical-align:top;"),Bd.setAttribute("style","display:block;vertical-align:middle;"+e.setframe_label_style),c.appendChild(Bd),c.appendChild(jb),E.appendChild(c),jb.addEventListener("input",function(a){Z(!1);a=parseInt(jb.value,10)-1;0<=Ea[a]&&(Aa(a),Bd.innerHTML=ke.replace("*",x+1));qa()},!1),Ye=!0);"framelabel"==k&&(Ga=n("button"),N&&(Ga.className="framelabel"),Ga.innerHTML="",Pa=null,l=e.frame_labels,null!=l&&(Pa=
l.split(","),Ga.innerHTML=Pa[0]),c=lc+e.framelabel_style,null!=c&&Ga.setAttribute("style",c),c=e.framelabel_position,null!=c&&(c=c.split(","),Ga.style.position="absolute",Ga.style.left=F.offsetLeft+parseInt(c[0],10)+"px",Ga.style.top=F.offsetTop+parseInt(c[1],10)+"px"),E.appendChild(Ga));if("autorefresh"==k||"autorefresh/off"==k)null!=wc&&clearInterval(wc),gc=n("button"),N&&(gc.className="autorefresh"),ea(gc,"autorefresh","Desactivar AutoRefresh","Activar AutoRefresh",f),gc.addEventListener("click",
HAniS.toggleAutoRefresh,!1),id=!1,E.appendChild(gc),"autorefresh"==k?HAniS.toggleAutoRefresh():J(gc,!1,"autotoggle off");"backward"==k&&(Va=n("button"),N&&(Va.className="step back"),ea(Va,"backward","<","<",f),Va.addEventListener("click",function(){Z(!1);cb(-1);qa()},!1),E.appendChild(Va));"forward"==k&&(Wa=n("button"),N&&(Wa.className="step forward"),ea(Wa,"forward",">",">",f),Wa.addEventListener("click",function(){Z(!1);cb(1);qa()},!1),E.appendChild(Wa));if("step"==k){c=e.step_labels;var O=null!=
c?c.split(","):["<",">"];Va=n("button");N&&(Va.className="step back");Va.innerHTML=O[0];Va.addEventListener("click",function(){Z(!1);cb(-1);qa()},!1);c=lc+e.step_style;null!=c&&Va.setAttribute("style",c);null!=f&&(Va.title=f);E.appendChild(Va);Wa=n("button");N&&(Wa.className="step forward");Wa.innerHTML=O[1];Wa.addEventListener("click",function(){Z(!1);cb(1);qa()},!1);null!=c&&Wa.setAttribute("style",c);null!=f&&(Wa.title=f);E.appendChild(Wa)}"first"==k&&(ob=n("button"),N&&(ob.className="firstlast first"),
ea(ob,"first","|<","|<",f),ob.addEventListener("click",function(){Z(!1);Aa(oa(0));qa()},!1),E.appendChild(ob));"last"==k&&(pb=n("button"),N&&(pb.className="firstlast last"),ea(pb,"last",">|",">|",f),pb.addEventListener("click",function(){Z(!1);Aa(oa(v-1));qa()},!1),E.appendChild(pb));"firstlast"==k&&(c=e.firstlast_labels,O=null!=c?c.split(","):["<<",">>"],ob=n("button"),N&&(ob.className="firstlast"),ob.innerHTML=O[0],ob.addEventListener("click",function(){Z(!1);Aa(oa(0));qa()},!1),c=lc+e.firstlast_style,
null!=c&&ob.setAttribute("style",c),null!=f&&(ob.title=f),E.appendChild(ob),pb=n("button"),N&&(pb.className="firstlast"),pb.innerHTML=O[1],pb.addEventListener("click",function(){Z(!1);Aa(oa(v-1));qa()},!1),null!=c&&pb.setAttribute("style",c),null!=f&&(pb.title=f),E.appendChild(pb));"setspeed"==k?(wb=n("input"),N&&(wb.className="setspeed"),wb.type="range",wb.min=Hb,wb.max=Cc,wb.value=Cc-Ua,null!=f&&(wb.title=f),c="vertical-align:middle;"+e.setspeed_style,wb.setAttribute("style",c),wb.addEventListener("input",
function(a){Ua=Cc-parseInt(wb.value,10)+30;Z(!0);qa()},!1),E.appendChild(wb)):"speed"==k&&(c=e.speed_labels,O=null!=c?c.split(","):["-","+"],Ib=n("button"),N&&(Ib.className="speed slower"),Ib.innerHTML=O[0],Ib.addEventListener("click",function(){Ua+=Re;Jb.disabled=!1;Ua>Cc&&(Ua=Cc,Ib.disabled=!0)},!1),c=lc+e.speed_style,null!=c&&Ib.setAttribute("style",c),null!=f&&(Ib.title=f),E.appendChild(Ib),Jb=n("button"),N&&(Jb.className="speed faster"),Jb.innerHTML=O[1],Jb.addEventListener("click",function(){Ua-=
Re;Ib.disabled=!1;Ua<Hb&&(Ua=Hb,Jb.disabled=!0)},!1),null!=c&&Jb.setAttribute("style",c),null!=f&&(Jb.title=f),E.appendChild(Jb));"zoom"==k&&(ua=n("button"),N&&(ua.className="zoom off"),ea(ua,"zoom","Zoom","Un-zoom",f),ua.addEventListener("click",HAniS.toggleZooming,!1),E.appendChild(ua));if("annotate"==k){bd=n("button");N&&(bd.className="annotate");ea(bd,"annotate","Herramientas","Terminado",f);na=n("div");na.setAttribute("style","position:absolute;height:140px;width:200px;top:20px;left:20px;z-index:15;visibility:hidden;background-color:lightgray;border-width:4px;border-style:solid;border-color:black;border-radius:5px;padding:10px;font-family:Arial;font-size:12px;color:black;");
na.title="Arrastre esta caja a donde desee.  Seleccione la herramienta, luego dibuje sobre la imagen";nc=oc=20;le=Qb=!1;wg=3;xg=11;r=[];na.addEventListener("mousedown",function(a){le=!0;yg=a.clientX-oc;zg=a.clientY-nc},!1);na.addEventListener("mouseup",function(a){le=!1},!1);na.addEventListener("mouseout",function(a){le&&(oc=a.clientX-yg,nc=a.clientY-zg,na.style.top=nc+"px",na.style.left=oc+"px")},!1);na.addEventListener("mousemove",function(a){le&&(oc=a.clientX-yg,nc=a.clientY-zg,na.style.top=nc+"px",na.style.left=
oc+"px")},!1);bd.addEventListener("click",function(){if(Qb=!Qb){r=[];oc=F.offsetLeft;nc=F.offsetTop;var a=e.annotate_position;null!=a&&(a=a.split(","),oc+=parseInt(a[0],10),nc+=parseInt(a[1],10));na.style.top=nc+"px";na.style.left=oc+"px";na.style.visibility="visible";J(bd,!1,"annotate off");lh=ra;ra=!1;null!=ua&&(ua.disabled=!0)}else na.style.visibility="hidden",J(bd,!0,"annotate on"),ra=lh,null!=ua&&(ua.disabled=!1);G()},!1);Cd=Ag("Color Negro Blanco Rojo Verde Azul Cyan Magenta".split(" "),"black black white red green blue cyan magenta".split(" "),
function(a){});pc=Ag("Ancho 1 2 3 4 5 6 7 8 10 12 14 16 18 20 24 28 32 36 38".split(" "),[1,1,2,3,4,5,6,7,8,10,12,14,16,18,20,24,28,32,36,38],function(a){6==Dd.selectedIndex?xg=pc.selectedIndex:wg=pc.selectedIndex});pc.title="Seleccionar ancho o tamaño del texto";Dd=Ag("Tipo Flecha Circulo Caja Poligono Dibujo Texto".split(" "),[-1,0,1,2,3,4,5],function(a){6==Dd.selectedIndex?(xb.focus(),xb.select(),pc.selectedIndex=xg):pc.selectedIndex=wg;0==Cd.selectedIndex&&(Cd.selectedIndex=2)});c=n("button");c.style.width="70px";
c.style.margin="5px";c.innerHTML="Borrar";c.title="Borrar ultimo item";c.addEventListener("click",function(){0<r.length&&(r.pop(),G())},!1);xb=n("input");xb.type="text";xb.style.width="150px";xb.style.margin="5px";xb.title="Ingrese texto";xb.value="Ingrese texto";O=e.annotate_defaults;null!=O&&(O=O.split(","),Dd.selectedIndex=parseInt(O[0],10),1<O.length&&(Cd.selectedIndex=parseInt(O[1],10)),2<O.length&&(pc.selectedIndex=parseInt(O[2],10)),3<O.length&&(xb.value=O[3].trim()));
O=n("div");O.innerHTML="Herramientas";var q=n("div");q.appendChild(Dd);q.appendChild(Cd);var m=n("div");m.appendChild(pc);m.appendChild(c);c=n("div");c.appendChild(xb);na.appendChild(O);na.appendChild(q);na.appendChild(m);na.appendChild(c);E.appendChild(bd);F.appendChild(na)}"saveall"==k&&(me=n("button"),N&&(me.className="saveall"),ea(me,"saveall","SaveAll","SaveAll",f),Bg=e.saveall_prompt,Rb=e.saveall_filename,c=e.saveall_list,Cg=null==c?["0"]:c.split(","),me.addEventListener("click",function(){for(var a=
0;a<Cg.length;a++)for(var b=parseInt(Cg[a],10),c=0;c<ta.length;c++){0===c&&null!=Bg&&(Rb=window.prompt(Bg,Rb),null!=Rb&&1>Rb.length&&(Rb=null));var d=null==Rb?"":-1!=Rb.indexOf("#")?Rb.replace("#",c.toString()):Rb+c;var g=document.createElement("a");g.href=0==b?ta[c]:pa[c][b-1];g.download=d;d=new MouseEvent("click");g.dispatchEvent(d)}},!1),E.appendChild(me));if("capture"==k){ne=n("button");N&&(ne.className="capture");ea(ne,"capture","Capture","Capture",f);var t=e.capture_prompt;ef=e.capture_filename;
null==ef&&(ef="haimage.png");ne.addEventListener("click",function(){var a=ef;if(null!=t&&(a=window.prompt(t,a),null==a))return;var b=n("canvas");b.height=sb.height;b.width=sb.width;var c=b.getContext("2d");Ad=!1;G();c.drawImage(sb,0,0);c.drawImage($b,0,0);Ad=!0;b.toBlob(function(b){var c=URL.createObjectURL(b),d=document.createElement("a");d.href=c;d.download=a;c=new MouseEvent("click");d.dispatchEvent(c);setTimeout(function(){URL.revokeObjectURL(b)},3E4)})},!1);E.appendChild(ne)}"show"==k&&(oe=n("button"),
N&&(oe.className="show"),ea(oe,"show","Show","Show",f),ff=e.show_prompt,mh=e.show_image_file,null==ff&&(ff="Right-click to save or copy the image<br> <font size='-1'>(to save in some browsers, you may need to first 'Open in New Tab')</font> <p>"),oe.addEventListener("click",function(){if(mh)window.open(ta[x]);else{var a=sb.toDataURL("image/png;base64;");var b=window.open();b.document.write(ff+"<img src="+a+"></img>")}},!1),E.appendChild(oe));"toggle"==k&&(Ea=[],c=e.toggle_size,null!=c?(c=c.split(","),
cd=parseInt(c[0],10),pe=parseInt(c[1],10),qe=parseInt(c[2],10)):(pe=cd=10,qe=3),Dg="red",Eg="blue",Fg="orange",Gg=!1,M(e.toggle_layout_width,"t")&&(Gg=!0),c=e.toggle_colors,null!=c&&(c=c.split(","),Eg=c[0].trim(),Dg=c[1].trim(),Fg=c[2].trim()),qb=n("div"),qb.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;"),qb.style.backgroundColor=E.style.backgroundColor,
qb.align=gd,Hg=new PEvs(qb,null,null,null,null,HAniS.togclick,null),Lc=n("canvas"),Lc.height=2*pe,gf=Lc.getContext("2d"),qb.appendChild(Lc),a?F.insertBefore(qb,Ka):F.appendChild(qb),c=e.toggle_onoff,re=null,null!=c&&(re=c.split(",")),hf=!0,null!=f&&(qb.title=f));if("overlay"==k){B=[];k=e.overlay_tooltip;f=null;null!=k&&(f=k.split(","));k=e.overlay_radio;c=null;null!=k&&(c=k.split(","));q=e.overlay_labels_color;O=null;null!=q&&(O=q.split(","));yd=[];m=e.overlay_caching;q=null;null==m&&(m=e.overlay_static);
null!=m&&(q=m.split(","));var u=!0;null!=e.overlay_nonewdiv&&(u=!1);for(m=0;m<Fb.length;m++){var z=Fb[m].trim();if(0==m||0==z.indexOf("/"))0==z.indexOf("/")&&(z=z.substr(1)),u?(yb=n("div"),Ig++,yb.align="center",a?F.insertBefore(yb,Ka):F.appendChild(yb)):(yb=n("span"),E.appendChild(yb)),l=e.overlay_labels_style,null!=l&&yb.setAttribute("style",l);var p=!1;l=z.length;0<z.indexOf("/on")&&z.indexOf("/on")==l-3&&(p=!0,z=z.substr(0,l-3));var w=!1;0<z.indexOf("/always")&&z.indexOf("/always")==l-7&&(w=p=
!0);var y=!1;0<z.indexOf("/hidden")&&(y=!0);var A=!1;0<z.indexOf("/hotspots")&&(A=!0,z=z.substr(0,z.indexOf("/")));null!=q?M(q[m],"y")||M(q[m],"t")?yd[m]=!0:yd[m]=!1:yd[m]=!0;B[m]=n("input");B[m].type="checkbox";B[m].value=z;B[m].id=z;B[m].showMe=!(w&y)&!A;var D="vertical-align:middle;";l=e.checkbox_style;null!=l&&(D+=l);B[m].setAttribute("style",D);B[m].checked=p;B[m].name=0;B[m].hotspotIndex=A;null!=sa&&m==db&&B[m].checked&&(sa.disabled=!1);null!=cc&&!cc[m]&&p&&(Pc=!1);B[m].addEventListener("click",
HAniS.overClick,!1);null!=k&&(l=c[m].indexOf("/"),-1!=l&&(B[m].name=c[m].substr(l+1).trim()),M(c[m],"t")&&(B[m].type="radio",-1==l&&(B[m].name="all")));B[m].isGhost=!0;w||y||(null!=f&&(B[m].title=f[m]),l=n("label"),l.htmlFor=z,null!=f&&(l.title=f[m]),l.innerHTML=z,l.name=B[m].name,z="vertical-align:middle;",null!=O&&(z=z+"color:"+O[m]+";"),l.setAttribute("style",z),z=n("span"),w="10",null!=Yd&&(w=10+Yd[m]),z.setAttribute("style","margin-left:"+w+"px;"),z.appendChild(B[m]),z.appendChild(l),yb.appendChild(z),
B[m].isGhost=!1)}if(null==Gb)for(Gb=Array(Fb.length),m=0;m<Fb.length;m++)Gb[m]=0;else for(m=0;m<Fb.length;m++)ab(m)}}mb=!0;l=e.start_looping;null!=l&&M(l,"f")&&(mb=!1,c=l.split(","),1<c.length&&(x=Jg=parseInt(c[1],10)-1));Z(mb)}function ab(b){var a;if(0>Gb[b]){var d=!1;for(a=0;a<Fb.length;a++)Gb[a]!=-Gb[b]||d||(d=B[a].checked);B[b].checked=d}}function Nc(b){0==lb&&(kb=[]);b=b.substr(b.indexOf("=")+1).trim().split(",");var a=b[4].trim(),d=b[4].indexOf("/"),c=b[4].indexOf("?"),g=-1,e=-1;-1!=d&&(g=parseInt(b[4].substring(d+
1),10)-1,a=a.substring(0,d));-1!=c&&(e=parseInt(b[4].substring(c+1),10)-1,c<d||-1==d)&&(a=a.substring(0,c));kb[lb]=new Xb(parseInt(b[0].trim(),10),parseInt(b[1].trim(),10),b[2].trim(),b[3].trim(),a.toLowerCase(),b[5].trim().toLowerCase(),b[6].trim(),g,e,8==b.length?b[7].trim():null);lb+=1}function Nd(b){0==ie&&(Da=[],ja=null);var a=b.substr(b.indexOf("=")+1).trim().split("(");b=a[0].split(",");var d=b[0].trim();0==d.indexOf("0x")&&(d="#"+d.substring(2));Da[ie]=new Pd(d,b[1].trim(),b[2].trim(),b[3].trim(),
a[1].trim());ie+=1}function Od(b){0==ib&&(xa=[]);b=b.substr(b.indexOf("=")+1).trim().split(",");xa[ib]=new rc(parseInt(b[0],10)-1,parseInt(b[1],16),b[2].trim(),b[3].trim(),5==b.length?b[4].trim():"Click for details");ib+=1}function Pd(b,a,d,c,g){this.color=b;this.alpha=1;7<this.color.length&&(this.alpha=parseInt(this.color.substring(7),16)/255,this.color=this.color.substring(0,7),.1>this.alpha&&(this.alpha=.1));this.action=a;this.value=d;this.tip=c;this.poly=g;b=g.split(",");this.xy=[];this.ymin=
this.xmin=9999;for(a=this.ymax=this.xmax=0;a<b.length;a++)this.xy[a]=parseInt(b[a].trim(),10),0==a%2?(this.xy[a]<this.xmin&&(this.xmin=this.xy[a]),this.xy[a]>this.xmax&&(this.xmax=this.xy[a])):(this.xy[a]<this.ymin&&(this.ymin=this.xy[a]),this.xy[a]>this.ymax&&(this.ymax=this.xy[a]));this.height=this.ymax-this.ymin+1;this.width=this.xmax-this.xmin+1;this.can=n("canvas");this.can.height=this.height;this.can.width=this.width;this.ctx=this.can.getContext("2d");this.ctx.imageSmoothingEnabled=!1;this.ctx.fillStyle=
this.color;this.ctx.globalAlpha=this.alpha;this.ctx.beginPath();this.ctx.moveTo(this.xy[0]-this.xmin,this.xy[1]-this.ymin);for(a=2;a<this.xy.length;a+=2)this.ctx.lineTo(this.xy[a]-this.xmin,this.xy[a+1]-this.ymin);this.ctx.closePath();this.ctx.fill()}function rc(b,a,d,c,g){this.overlay=b;this.color=a;this.action=d;this.value=c;this.tip=g}function Xb(b,a,d,c,g,e,f,k,h,l){this.x0=b;this.y0=a;this.icon=null;this.isIcon=!1;if("icon"==d)this.icon=new Image,this.icon.hotspot=this,jf=!0,this.icon.onload=
function(a){this.gotit=!0;this.hotspot.x1=this.hotspot.x0+this.width;this.hotspot.y1=this.hotspot.y0+this.height;this.hotspot.width=this.width;this.hotspot.height=this.height;this.hotspot.w2=this.width/2;this.hotspot.h2=this.height/2;this.hotspot.isIcon=!0;this.hotspot.origX=0;this.hotspot.origY=0},this.y1=this.x1=-1,this.zoomme=this.fromfile=this.anim=!1,this.icon.gotit=!1,this.icon.src=c.trim();else if("sprite"==d||"spritefn"===d){this.x0=b;this.y0=a;this.inx=parseInt(c,10)-1;Ed=!1;Jf?null!=da&&
(-1!=Gc?this.inx>=Gc&&this.inx<=Gc+da.length&&(Ed=!0):"spritefn"===d&&(Ed=!0)):Ed=!0;if(Ed){-1!=Gc&&(this.inx-=Gc);if(this.inx>=da.length)return null;this.x1=da[this.inx].width+b;this.y1=da[this.inx].height+a;this.width=da[this.inx].width;this.height=da[this.inx].height;this.w2=this.width/2;this.h2=this.height/2;this.origY=this.origX=0;this.icon=da[this.inx].cloneNode();this.anim=da[this.inx].anim;this.fromfile=da[this.inx].fromfile;this.zoomme=da[this.inx].zoomme;this.anim&&(this.icon.setAttribute("style",
"position:absolute;top:0px;left:0px;visibility:hidden;"),hc.appendChild(this.icon))}else this.x1=Db[this.inx]+b,this.y1=Eb[this.inx]+a,this.width=Db[this.inx],this.height=Eb[this.inx],this.w2=Db[this.inx]/2,this.h2=Eb[this.inx]/2,this.origX=Ie[this.inx],this.origY=Je[this.inx],this.icon=He,this.zoomme=this.fromfile=this.anim=!1;jf=this.isIcon=!0;this.icon.gotit=!0}else this.width=parseInt(d,10),this.height=parseInt(c,10),this.x1=this.width+b,this.y1=this.height+a,this.w2=this.width/2,this.h2=this.height/
2;this.pan=g;this.isPan=!1;"pan"===this.pan&&(this.isPan=!0);this.action=e;this.value=f;this.overlay=k;this.frame=h;this.tip=l}function sc(){if(Fd){va=-1;for(var b=0;b<Za.length;b++)D>=Za[b]&&(va=b)}}function Cb(){null!=Lb?Qa=Lb.toLatLon(ka,la):null!=We?(Qa[0]=We+(gh-We)*la/Y,Qa[1]=qg+(hh-qg)*ka/ha):(Qa[0]=Math.round(ka),Qa[1]=Math.round(la))}function tc(b,a){"popup"==b.action?(null!=kf&&kf.close(),kf=window.open("","HAniSPopup","scrollbars=yes,width="+fg+",height="+eg),kf.document.write(dg+b.value+
"</div>")):"link"==b.action?(b=b.value,Cb(),b=b.replace("%LATITUDE%",Qa[0].toFixed(4)),b=b.replace("%LONGITUDE%",Qa[1].toFixed(4)),b=b.replace("%FRAMENUMBER%",x+1),window.open(b,"_blank","")):"fof"==b.action&&(ba=$f,HAniS.resetZoom(),HAniS.newFOF(b.value,!0),Be(a))}function uc(b){var a=!1;b?(D-=.1*pd/t,L-=.1*pd/w):(!hg||D!==Bc&&L!==Bc||(a=!0),D+=.1*pd/t,L+=.1*pd/w,D>Bc&&(D=Bc),L>Bc&&(L=Bc));a||D<=lf||L<=se?(D=lf,L=se,ka=u,la=p,y=C=0,za=Y,Oa=ha,be=Tc=0,Xc&&(Ya=!0)):(C=ka-u/D,y=la-p/L,za=Math.floor(Y/
L),y+za>Y-Tc&&(y=Y-Tc-za),Oa=Math.floor(ha/D),y=Math.round(y),C=Math.round(C),Tc=bg,be=cg,Xc&&(Ya=!1));sc()}function Rd(){te=0;zb=Array(2);rb=Array(2);dd=Array(2);Ha=0;Sc=null;Aa(oa(0))}function Z(b){Fa=!b;HAniS.toggleIsLooping()}function Sd(b,a,d,c,g,e){vd.clearRect(0,0,R,U);vd.imageSmoothingEnabled=jd;H.imageSmoothingEnabled=jd;vd.drawImage(b,a,d,c,g,0,0,R,U);Kg=vd.getImageData(0,0,R,U);Mc=Kg.data;mf=La[e];nf=Ma[e];of=Na[e];pf=td[e];nh=4*R*U;for(Sb=0;Sb<nh;Sb+=4)Ra=Mc[Sb],Ra===Mc[Sb+1]&&Ra===Mc[Sb+
2]&&(Mc[Sb]=mf[Ra],Mc[Sb+1]=nf[Ra],Mc[Sb+2]=of[Ra],Mc[Sb+3]=pf[Ra]);vd.putImageData(Kg,0,0);H.drawImage(ee,0,0,R,U)}function J(b,a,d){null!=b&&(a?(null!=b.style_on&&b.setAttribute("style",b.style_on),b.innerHTML=b.label_on):(null!=b.style_off&&b.setAttribute("style",b.style_off),b.innerHTML=b.label_off),N&&(b.className=d))}function Ta(b,a){if(!(b>=v)&&(-2==Ea[b]&&(a=-2),Ea[b]=a,Ye&&1==a&&(jb.value=b+1,Bd.innerHTML=ke.replace("*",b+1)),hf)){b=Lg+b*(cd+qe);var d=Fg;0==a?d=Eg:-1==a?d=Dg:-2==a&&(d=Lf);
gf.fillStyle=d;gf.fillRect(b,pe/2,cd,pe)}}function Qd(b,a){hf&&(Lc.width=Gg?parseInt(F.style.width,10):R,gf.clearRect(0,0,Lc.width,Lc.height),Lg=Lc.width/2-b*(cd+qe)/2);for(var d=0;d<b;d++)a?-1!=ld?Ta(d,-2):null!=re&&"n"==re[d].toLowerCase().trim()?Ta(d,-1):Ta(d,0):Ta(d,Ea[d])}function Aa(b){Ta(x,0);x=b;Ta(x,1);null!=Ga&&null!=Pa&&null!=Pa[x]&&(Ga.innerHTML=Pa[x])}function oa(b){b>=v&&(b=v-1);if(0<=Ea[b])return b;var a=-1,d=b;0==d&&(a=1);for(var c=0;c<v-1;c++)if(d+=a,0<=Ea[d])return d;return b}function cb(b){Ta(x,
0);var a=b;do 0<a?(a=oa(v-1),x+=1,x>a&&(Gd&&Fa?(x=a,b=-b):x=oa(0))):(a=oa(0),--x,x<a&&(Gd&&Fa?(x=a,b=-b):x=oa(v-1))),a=b;while(0>Ea[x]);df=a;Ta(x,1);null!=Ga&&null!=Pa&&null!=Pa[x]&&(Ga.innerHTML=Pa[x])}function bb(b,a,d,c,g,e,f){this.bg=b;null!=b&&0==this.bg.indexOf("0x")&&(this.bg="#"+this.bg.substring(2));this.fg=a;null!=a&&0==this.fg.indexOf("0x")&&(this.fg="#"+this.fg.substring(2));this.font=d;this.fontHeight=Math.round(1.1*parseInt(d,10));this.scolor=c;null!=c&&0==this.scolor.indexOf("0x")&&
(this.scolor="#"+this.scolor.substring(2));this.sblur=g;this.sxoff=e;this.syoff=f}function Ja(b,a,d,c,g){h.globalAlpha=1;h.font=b.font;var e=b.fontHeight;d=d-e-6;var f=h.measureText(c).width;1==g&&(a-=f);0==g&&(a-=f/2);5>a&&(a=5);5>d&&(d=5);d+e+3>U&&(d=U-e-6);a+3+f>R&&(a=R-f-6);h.save();h.beginPath();h.fillStyle=b.bg;null!=b.scolor&&(h.shadowColor=b.scolor,h.shadowBlur=b.sblur,h.shadowOffsetX=b.sxoff,h.shadowOffsetY=b.syoff);ue=a-3;qf=d;Mg=f+6;rf=e+6;h.fillRect(ue,qf,Mg,rf);h.closePath();h.restore();
h.textBaseline="bottom";h.fillStyle=b.fg;h.fillText(c,a,d+e+3)}function G(){h.clearRect(0,0,R,U);sf=!1;if(Sa){h.beginPath();h.lineWidth=2;h.strokeStyle="white";var b=Ha;1<b&&(b=2);for(var a=0;a<b;a++)1<Ha&&(h.moveTo(zb[0]/t,rb[0]/w),h.lineTo(zb[1]/t,rb[1]/w)),h.moveTo(zb[a]/t-15,rb[a]/w),h.lineTo(zb[a]/t+15,rb[a]/w),h.moveTo(zb[a]/t,rb[a]/w-15),h.lineTo(zb[a]/t,rb[a]/w+15);h.closePath();h.stroke();if(3==Ha){var d=S,c=P;h.moveTo(d,c);h.fillStyle=dc;h.fillRect(d-2,c-2,5,5);b=ed;a=Math.round(d+ve/t*
Hd*(ed-dd[1]));for(var g=Math.round(c+Id/w*Hd*(ed-dd[1])),e=0;300>e;e++){h.beginPath();h.lineWidth=1;h.strokeStyle=dc;h.moveTo(d,c);h.lineTo(a,g);h.stroke();h.beginPath();h.lineWidth=3;h.rect(a-2,g-2,5,5);h.stroke();if(3>a||a+3>R||3>g||g+3>U)break;c=Mb+b;c=100*Math.floor(c/60)+c%60;c%=2400;Vf?(d="AM",1200<=c?(1300<=c&&(c-=1200),d="PM"):100>c&&(c+=1200),d=Math.floor(c/100)+":"+Math.floor(Math.floor(c%100)/10)+Math.floor(c%10)+" "+d):(d=c+" ",1E3>c&&(d="0"+c),100>c&&(d="00"+c),10>c&&(d="000"+c));c=
0;Math.abs(tf)<Rc+5&&(c=45*.0174533);var l=g;0>Ng*tf&&0==c&&(l=g+Rc);h.font=nd;d=d+" "+Uf;var k=h.measureText(d).width;h.fillStyle=md;0===c?(h.fillRect(a+2,l-Rc-2+c,k+4,Rc+3),h.fillStyle=dc,h.textBaseline="bottom",h.fillText(d,a+5,l)):(h.save(),h.translate(a+5,g),h.rotate(c),h.fillRect(2,-2,k+4,Rc+3),h.fillStyle=dc,h.textBaseline="bottom",h.fillText(d,5,Rc),h.restore());d=a;c=g;a=Math.round(d+Hd*Ng);g=Math.round(c+Hd*tf);b+=T}}null!=Sc&&Ja(Oe,oh,ph,Sc,0);Ad&&(Ja(ch,9999,lg,kg[te],0),Og=ue,Pg=qf,Qg=
qf+rf)}if(nb){Ad&&(0==ad?Ja(vg,9999,10,ce[0],0):(Ja(kh,10,10,ce[1],0),qh=ue+Mg,Ja(vg,9999,10,ce[2],0)),rh=ue,sh=rf);h.beginPath();h.lineWidth=2;h.strokeStyle=mg;for(b=0;b<ia.length;b+=2)0==b?h.moveTo(ia[b]/t,ia[b+1]/w):h.lineTo(ia[b]/t,ia[b+1]/w);4<ia.length&&h.lineTo(ia[0]/t,ia[1]/w);h.stroke();for(b=0;b<ia.length;b+=2)h.beginPath(),h.rect(ia[b]/t-2,ia[b+1]/w-2,5,5),h.stroke()}if(Qb)for(b=0;b<r.length;b++){a=r[b].type;h.beginPath();h.strokeStyle=r[b].color;h.lineWidth=r[b].width;if("0"==a)a=Math.atan2(r[b].xe-
r[b].x,r[b].ye-r[b].y),g=r[b].x+r[b].width*Math.sin(a),e=r[b].y+r[b].width*Math.cos(a),h.beginPath(),h.moveTo(g,e),h.lineTo(r[b].xe,r[b].ye),d=12+r[b].width/5,h.moveTo(g+d*Math.sin(a-.523599),e+d*Math.cos(a-.523599)),h.lineTo(g,e),h.lineTo(g+d*Math.sin(a+.523599),e+d*Math.cos(a+.523599));else if("1"==a)h.arc(r[b].x,r[b].y,r[b].size,0,2*Math.PI);else if("2"==a)h.rect(r[b].x-r[b].size,r[b].y-r[b].size,2*r[b].size,2*r[b].size);else if("3"==a){h.moveTo(r[b].xp[0],r[b].yp[0]);for(g=1;g<r[b].xp.length;g++)h.lineTo(r[b].xp[g],
r[b].yp[g]);h.lineTo(r[b].xp[0],r[b].yp[0])}else if("4"==a)for(h.moveTo(r[b].xp[0],r[b].yp[0]),g=1;g<r[b].xp.length;g++)h.lineTo(r[b].xp[g],r[b].yp[g]);else"5"==a&&(h.fillStyle=r[b].color,h.font=r[b].width+"pt arial",a=h.measureText(r[b].text).width,h.fillText(r[b].text,r[b].x-a/2,r[b].y+r[b].width/2));h.stroke()}Jc&&(b=vc*(we-Jd)/D,a=Ud*(xe-Kd)/L,b=" "+Math.sqrt(b*b+a*a).toFixed(Ef)+" "+Df+" ",Ja(ah,Jd/t,Kd/w,b,-1),h.beginPath(),h.strokeStyle=Ff,h.lineWidth=3,h.moveTo(we/t,xe/w),h.lineTo(Jd/t,Kd/
w),h.stroke(),h.closePath());tb&&Ja(Zf,Rg,Sg,Tg,-1);if(ac||Zc)if(S=ma.getX(),u=S*t,P=ma.getY(),p=P*w,0<=u&&0<=p){ka=C+u/D;la=y+p/L;if(Zc){Cb();th=Af+Qa[0].toFixed(Ee)+"  "+Bf+Qa[1].toFixed(Ee);b=P;if(Jc||tb)b=P+Cf.fontHeight+6;Ja(Cf,S+10,b,th,-1)}if(ac)if(ka=Math.round(ka),la=Math.round(la),Fe)Ia.clearRect(0,0,1,1),Ia.drawImage(ya[x],ka,la,1,1,0,0,1,1),K=Ia.getImageData(0,0,1,1).data,I=0,f(!1);else for(b=0;b<fa;b++)if(a=fa-b-1,A[x][a].gotit&&B[a].checked&&(a==db||null!=bc[a]&&0<=bc[a])){Ia.clearRect(0,
0,1,1);a==db?Ia.drawImage(Nb[x],ka,la,1,1,0,0,1,1):Ia.drawImage(A[x][a],ka,la,1,1,0,0,1,1);K=Ia.getImageData(0,0,1,1).data;I=bc[a];null!=I&&f(a==db||pg);break}}!Ya||Sa||Zb||ac||null==ja||(h.drawImage(ja.can,0,0,ja.width,ja.height,ja.xmin/t,ja.ymin/w,ja.width/t,ja.height/w),Ja(Zf,(ja.xmin+ja.xmax)/2/t,(ja.ymin+ja.ymax)/2/w,ja.tip,0),sf=!0)}function f(b){ye=999;Tb=Gf;var a=hb[I].length-1;if(0==K[3])Tb=de[I];else{if(Hf)Ub=K[0];else if(b)uf=0,Ub=K[0],ye=0;else for(var d=0;d<a;d++)Vb[0]=K[0]-La[I][d],
0>Vb[0]*(La[I][d+1]-K[0]-1)||(Vb[1]=K[1]-Ma[I][d],0>Vb[1]*(Ma[I][d+1]-K[1]-1)||(Vb[2]=K[2]-Na[I][d],0>Vb[2]*(Na[I][d+1]-K[2]-1)||(fd=Te[I][d],vf=Vb[fd]/Fc[I][d][fd],Ug=Math.abs(Vb[Vg[fd]]-vf*Fc[I][d][Vg[fd]])+Math.abs(Vb[Wg[fd]]-vf*Fc[I][d][Wg[fd]]),Ug<ye&&(Ub=d,ye=Ug,uf=vf))));if(999>ye)Tb=Ec[I][Ub],-1!=Kb[I][Ub]&&(Xg=hb[I][Ub],0!=uf&&(Xg+=uf*(hb[I][Ub+1]-hb[I][Ub])),Tb=Tb+" "+Xg.toFixed(Kb[I][Ub])+" "+Dc[I][Ub]);else if(b||0<hd){var c=-1;if(b)c=K[0];else for(d=0;d<a;d++)if(Math.abs(K[0]-La[I][d])<
hd&&Math.abs(K[1]-Ma[I][d])<hd&&Math.abs(K[2]-Na[I][d])<hd){c=d;break}-1!=c&&(Tb=Ec[I][c],-1!=Kb[I][c]&&(Tb=Tb+" "+hb[I][c].toFixed(Kb[I][c])+" "+Dc[I][c]))}}"hide"!=Tb&&Ja(bh,S-10,P,Tb,1)}function qa(){if(zd)try{H.clearRect(0,0,R,U);H.globalAlpha=1;if(Fd&&null!=Ob&&0<=va&&Ob[va].gotit)H.drawImage(Ob[va],C*Za[va],y*Za[va],Oa*Za[va],za*Za[va],0,0,R,U);else if(ya[x].gotit&&(null!=Ke?Sd(ya[x],C,y,Oa,za,Ke):H.drawImage(ya[x],C,y,Oa,za,0,0,R,U)),null!=wa&&(H.globalAlpha=1,ya[x].gotit))for(var b=0;b<wa.length;b+=
4)H.drawImage(ya[x],wa[b],wa[b+1],wa[b+2],wa[b+3],wa[b]/t,wa[b+1]/w,wa[b+2]/t,wa[b+3]/w);if(0<fa){for(b=0;b<fa;b++){var a=null!=zc?zc[b]:b;!Me[a]&&B[a].checked&&B[a].showMe&&(null!=Zd&&(H.globalAlpha=Zd[a]),Fd&&null!=Pb&&0<=va&&Pb[va].gotit&&Yg==a?H.drawImage(Pb[va],C*Za[va],y*Za[va],Oa*Za[va],za*Za[va],0,0,R,U):A[x][a].gotit&&(null==Ac||1===Ac[a]?null!=xc&&0<=xc[a]?Sd(A[x][a],C,y,Oa,za,xc[a]):H.drawImage(A[x][a],C,y,Oa,za,0,0,R,U):0===Ac[a]&&H.drawImage(A[x][a],0,0,ha,Y,0,0,R,U)))}if(null!=eb)for(H.globalAlpha=
1,b=0;b<fa;b++)a=null!=zc?zc[b]:b,A[x][a].gotit&&(Tf[a]||B[a].checked)&&eb[a]&&H.drawImage(null!=A[x][a].origImage?A[x][a].origImage:A[x][a],aa[a][0],aa[a][1],aa[a][2],aa[a][3],aa[a][4]/t,aa[a][5]/w,aa[a][2]/t,aa[a][3]/w);ac&&G()}ug&&je();if(jf)for(H.globalAlpha=1,a=0;a<lb;a++)if(null!=kb[a]){var d=kb[a];null!=d.icon&&(d.icon.style.visibility="hidden");if((-1==d.frame||d.frame==x)&&null!=d.icon&&d.icon.gotit&&(-1==d.overlay||-1!=d.overlay&&B[d.overlay].checked)){if(d.isPan){d.zoomme&&(d.icon.style.width=
Math.round(d.width*D)+"px",d.icon.style.height=Math.round(d.height*L)+"px",d.w2=Math.round(d.width*D/2),d.h2=Math.round(d.height*L/2));var c=Math.round(((d.x0-C)*D-d.w2)/t);var g=Math.round(((d.y0-y)*L-d.h2)/w);if(d.anim){if(0>=c+d.icon.width||c>=ha||0>=g+d.icon.height||g>=Y)continue;d.icon.style.top=g+"px";d.icon.style.left=c+"px"}else H.drawImage(d.icon,d.origX,d.origY,d.width,d.height,c,g,d.width/t,d.height/w)}else H.drawImage(d.icon,d.origX,d.origY,d.width,d.height,d.x0/t,d.y0/w,d.width/t,d.height/
w);d.icon.style.visibility="visible"}}}catch(X){ca("Error:"+X)}}function je(){if(Qe&&ic>Xa){H.save();H.fillStyle="blue";H.strokeStyle="white";H.lineWidth=3;H.strokeRect(fe,ge,200,14);H.fillRect(fe,ge,Xa/ic*200,14);var b=H.measureText("Loading images").width;H.fillStyle="orange";H.font="14px arial";H.fillText("Loading images",fe+100-b/2,ge+11);H.restore()}else ug=!1,De&&(Yb.style.visibility="hidden");Xa>=ic&&!Fa&&Aa(oa(x))}function ca(b){if(Td&&Ce&&!Ce.closed)try{Ce.document.write(b+"<br>")}catch(a){}}
function jh(){Fa&&cb(df);uh=x==oa(v-1)?If+Ua:Ua;qa();setTimeout(function(){zh(jh)},uh)}function ze(b){for(;-180>b;)b+=360;for(;180<b;)b-=360;return b}function xh(){var b,a,d,c,g,e,f,k,h=Math.PI/180;this.init=function(c){for(var d=[],f=1;f<c.length;f++)d[f]=parseFloat(c[f]);a=d[1];b=d[4]/d[5];g=d[6];e=d[7];c=this.toXY(d[2],d[3]);g=c[0];e=c[1]};this.toXY=function(f,k){d=b*ze(k-a)*h-g;c=-b*f*h-e;return[d,c]};this.toLatLon=function(c,d){f=-(d+e)/b/h;k=ze((c+g)/b/h+a);return[f,k]}}function wh(){var b,
a,d,c,g,e,f,k,h,l,n,m,q,r,z,t,v,w,x,u,p,B,E,y,A,D,G,H,I,J,F,C=Math.PI/180;this.init=function(c){for(var d=[],g=1;g<c.length;g++)d[g]=parseFloat(c[g]);b=d[1];a=d[2];u=0==d[8]?!1:!0;p=d[6];B=p*p;E=B*B;y=E*B;A=E*E;f=d[5]/d[7];F=d[7];u?(k=Math.cos(C*b),h=Math.sin(C*b)):(k=Math.cos(-b*C),h=Math.sin(-b*C));v=k/Math.sqrt(1-B*h*h);x=(1-p*h)/(1+p*h);t=u?Math.tan(Math.PI/4-b*C/2)/Math.pow(x,p/2):Math.tan(Math.PI/4- -b*C/2)/Math.pow(x,p/2);r=d[9];z=d[10];c=this.toXY(d[3],d[4]);r=c[0];z=c[1]};this.toXY=function(k,
h){u?(g=C*k,e=C*(h-a)):(g=C*-k,e=C*(a-h));x=(1-p*Math.sin(g))/(1+p*Math.sin(g));w=Math.tan(Math.PI/4-g/2)/Math.pow(x,p/2);D=90!=b&&-90!=b?f*v*w/t:2*f*F*w/Math.sqrt(Math.pow(1+p,1+p)*Math.pow(1-p,1-p));d=D*Math.sin(e);c=D*Math.cos(e);u||(d=-d,c=-c);l=d-r;n=c-z;return[l,n]};this.toLatLon=function(e,k){d=e+r;c=k+z;D=Math.sqrt(d*d+c*c);w=90==b||-90==b?D*Math.sqrt(Math.pow(1+p,1+p)*Math.pow(1-p,1-p))/(2*f*F):D*t/(f*v);G=Math.PI/2-2*Math.atan(w);H=Math.sin(2*G);I=Math.sin(4*G);J=Math.sin(6*G);g=G+H*B/2+
5*H*E/24+H*y/12+13*H*A/360+7*I*E/48+29*I*y/240+811*I*A/11520+7*J*y/120+81*J*A/1120+4279*Math.sin(8*G)*A/161280;u?(m=g/C,q=Math.atan2(d,c)/C+a):(m=-g/C,q=-Math.atan2(-d,-c)/C+a);return[m,ze(q)]}}function yh(){var b,a,d,c,g,e,f,k,h,l,p,m,n,q,r,t,u,v,w,x,B,E,C,y,A,D,G,H,I,J,F,N,M,L,P,K=Math.PI/180;this.init=function(c){for(var g=[],e=1;e<c.length;e++)g[e]=parseFloat(c[e]);b=g[1];a=g[2];d=g[3];y=g[7];A=y*y;D=A*A;G=D*A;H=D*D;k=g[6]/g[8];h=Math.cos(K*b);l=Math.cos(K*a);m=Math.sin(b*K);p=Math.sin(a*K);B=
h/Math.sqrt(1-A*m*m);E=l/Math.sqrt(1-A*p*p);w=Math.sqrt((1-m)/(1+m)*Math.pow((1+y*m)/(1-y*m),y));x=Math.sqrt((1-p)/(1+p)*Math.pow((1+y*p)/(1-y*p),y));F=(Math.log(B)-Math.log(E))/(Math.log(w)-Math.log(x));N=B/(F*Math.pow(w,F));L=k*N*Math.pow(w,F);u=g[9];v=g[10];c=this.toXY(g[4],g[5]);u=c[0];v=c[1]};this.toXY=function(a,b){e=K*a;f=K*ze(b-d);P=Math.sin(e);C=Math.sqrt((1-P)/(1+P)*Math.pow((1+y*P)/(1-y*P),y));J=k*N*Math.pow(C,F);M=F*f;c=J*Math.sin(M);g=L+J*Math.cos(M);n=c-u;q=g-v;return[n,q]};this.toLatLon=
function(a,b){c=a+u;g=b+v;J=Math.abs(F)/F*Math.sqrt(c*c+(L-g)*(L-g));C=Math.pow(J/(k*N),1/F);I=Math.PI/2-2*Math.atan(C);M=0>F?Math.atan(-c/(g-L)):Math.atan(c/(L-g));f=M/F;e=I+(A/2+5/24*D+G/12+13/360*H)*Math.sin(2*I)+(7/48*D+29/240*G+811/11520*H)*Math.sin(6*I)+(7/120*G+81/1120*H)*Math.sin(6*I)+4279/161280*H*Math.sin(8*I);r=e/K;t=ze(d-f/K);return[r,t]}}var Kf,U,R,Y,ha,t,w,ng,og,ob,pb,Yb,De,ma,Td,kf,Ce,lc,wf,Le=!1,F,E,bf,cf,Ka,hc,Vc,sb,H,Ia,$b,h,ud,af,v,ta,fa,pa,Me,Fb,zc,Gb,ae,ba,$f,ya,A,B,Zd,yd,tb,
Tg,Rg,Sg,Qc,kd,Mf,Ba,Nf,xf,Zg,S,P,u,p,ka,la,Oa,za,C,y,Ad,N,Jg,ih,Fa,mb,x,df,Gd,Hc,Uc=!0,Xd,yf,e,Ua,Hb,Cc,Re,If,uh,jd,sa,Wc,yc,db,Ca,Nb,Ic,xd,Ze,he,Ke,ee,vd,Kg,Mc,Ra,mf,nf,of,pf,nh,Sb,xc,Ea,cd,pe,qe,Gg,qb,Lg,Hg,Dg,Eg,Fg,ld,Lf,kb,lb,jf,Pe,Ve,da,Gc,Ed,rg,ib,xa,K,zf,Da,ie,Ya,Xc,$e,wd,ja,sf,cc,Pc,Za,va,Ob,jc,Pb,kc,Fd,Pa,Ga,Yg,hf,re,Lc,gf,zd,Oc,gb,Wa,Va,wb,Jb,Ib,Yd,mc,nb,ad,ce,Se,mg,ia,kh,vg,rh,qh,sh,ub,Sa,Ha,zb,rb,dd,Og,kg,Pg,Qg,lg,ch,fb,Hd,ve,Id,$g,qd,Xe,Ng,tf,ed,T,te,Mb,$d,Uf,dc,md,nd,Rc,Vf,Wf,mh,oe,
ff,ne,ef,bd,r,me,Bg,Rb,Cg,na,Qb,yg,zg,oc,nc,le,lh,Dd,Cd,pc,xb,wg,xg,ua,ag,pd,D,L,lf,se,jg,fc,od,ig,gg,ra,Bc,Ae,hg,Of=!1,Pf,Qf,Rf,Ne,Sf,Yc,jb,ke,Bd,Ye,vb,Zb,we,xe,Ef,Vd,ue,qf,Mg,rf,sg=!0,tg,Jd,Kd,ah,Ff,Jc,vc,Ud,Df,Zf,Kc,Zc,Ee,Af,Bf,Cf,Lb,Qa,th,We,qg,gh,hh,wa,yb,Ig,Ac,eb,aa,Tf,rd,gc,dg,fg,eg,bc,ac,Wd,$c,Dc,Ec,Kb,fd,ye,bh,Gf,hd,Hf,Fe,Oe,Xf,Yf,Sc,oh,ph,Ub,uf,vf,Vg,Wg,Vb,I,Ug,Tb,Xg,hb,q,Fc,pg,La,Ma,Na,td,Te,de,vh,id,Ge,wc,Qe,ug,fe,ge,Xa,ic,Tc,He,Ie,Je,Db,Eb,Jf,bg,be,cg,gd,ec,Ah="N NNE NE ENE E ESE SE SSE S SSW SW WSW W WNW NW NNW N".split(" "),
zh=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,10)},n=function(b){return document.createElement(b)},M=function(b,a){if(null!=b)return 0==b.trim().toLowerCase().indexOf(a)},fh=function(b){void 0==wf&&(wf=n("textarea"));wf.innerHTML=b;return wf.value},Ag=function(b,a,d){var c=n("select");c.style.width="70px";c.style.margin="5px";for(var g=0;g<b.length;g++){var e=n("option");e.innerHTML=b[g];
e.value=a[g];c.add(e)}c.addEventListener("change",d,!1);return c},dh=function(b){b=b.split(",");v=b.length;ta=Array(v);for(var a=0;a<v;a++)ta[a]=null!=ba?ba+b[a].trim():b[a].trim();Oc=!1;v>fa&&(fa=0)},eh=function(b,a,d){var c=b;null!=ba&&(c=ba+b);ta=Array(v);for(var g=0;g<v;g++){b=g*d+a;if(0<=c.indexOf("*"))ta[g]=c.replace("*",b);else if(0<=c.indexOf("?")){for(var f=c;0<=f.lastIndexOf("?");){var h=f.lastIndexOf("?");f=f.substring(0,h)+b%10+f.substring(h+1);b=Math.floor(b/10)}ta[g]=f}else ta[g]=c+
g;ca("image filename = "+ta[g])}b=e.reverse_order;null!=b&&M(b,"t")&&ta.reverse();Oc=!1;v>fa&&(fa=0)};HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(b,a,d){d=window.atob(this.toDataURL(a,d).split(",")[1]);for(var c=d.length,g=new Uint8Array(c),e=0;e<c;e++)g[e]=d.charCodeAt(e);b(new Blob([g],{type:a||"image/png"}))}});this.setup=function(b,a,d){void 0==a&&(a="MORdivcan");tg=d;F=document.getElementById(a);gd="center";F.align=gd;Ka=n("div");
Ka.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;");sb=n("canvas");sb.setAttribute("style","position:absolute;top:0;left:0;z-index:1;");$b=n("canvas");$b.setAttribute("style","position:absolute;top:0;left:0;z-index:6;");h=$b.getContext("2d");h.imageSmoothingEnabled=!1;ud=n("canvas");ud.setAttribute("style","position:absolute;top:0;left:0;z-index:10;");
af=ud.getContext("2d");af.imageSmoothingEnabled=!1;hc=n("div");hc.setAttribute("style","position:absolute;top:0;left:0;z-index:5;overflow:hidden;border-width:0px;padding:0px;margin:0px;");Vc=n("div");Vc.setAttribute("style","position:absolute;top:0;left:0;z-index:10;overflow:hidden;border-width:0px;padding:0px;margin:0px;");Vc.appendChild(ud);ee=n("canvas");Ka.appendChild(Vc);Ka.appendChild(sb);Ka.appendChild($b);Ka.appendChild(hc);F.appendChild(Ka);ma=new PEvs(Ka,HAniS.down,HAniS.up,HAniS.move,HAniS.drag,
null,HAniS.canTip);F.setAttribute("tabindex",0);F.addEventListener("keyup",function(a){Qb||(yf=!1,a.preventDefault(),a.stopPropagation())},!1);F.addEventListener("keypress",function(a){Qb||(a.preventDefault(),a.stopPropagation())},!1);F.addEventListener("keydown",function(a){Qb||(a.preventDefault(),a.stopPropagation(),yf=a.ctrlKey?!0:!1,37==a.keyCode?(Z(!1),cb(-1),qa()):39==a.keyCode?(Z(!1),cb(1),qa()):32==a.keyCode?HAniS.toggleIsLooping():82==a.keyCode&&a.altKey&&HAniS.resetZoom())},!1);Vc.addEventListener("mouseenter",
function(a){F.focus()},!1);F.style.outlineWidth="0px";F.style.outline="none";F.focus();Jg=x=0;Gd=!1;df=1;mb=Fa=!0;lb=fa=v=0;Xd=!0;zc=null;Hc=!0;Ua=500;Hb=100;Cc=2E3;Re=30;If=0;Ge=6E4;wc=null;id=!1;$f=ae=ec=ba=null;se=lf=L=D=1;Ae=!1;y=C=za=Oa=la=ka=p=u=P=S=0;jg=!1;Uc=sg=!0;hf=De=Le=!1;ld=-1;Ea=[];ib=0;jf=!1;da=null;Gc=-1;Ve=0;Ed=!1;Ga=null;ge=fe=Xa=ic=0;pg=!1;I=0;tb=Pe=zd=!1;we=xe=Jd=Kd=0;Zc=Jc=Zb=!1;Lb=null;Qa=[0,0];Ya=Ye=Vd=!1;Pc=!0;ja=cc=null;nb=sf=!1;Ad=!0;ia=[];ac=Fe=Wd=!1;Vg=[1,0,0];Wg=[2,2,
1];Vb=[];bc=[];yc=Wc=Sa=!1;$d=te=0;yb=cf=bf=E=qb=null;Ig=0;yf=!1;a=n("canvas");a.height=1;a.width=1;Ia=a.getContext("2d");Ia.imageSmoothingEnabled=!1;$e=n("canvas");Td=!1;"string"===typeof b?0>b.indexOf("\n")?Ab(b):l(b.split("\n")):l(b)};this.newBasenames=function(b,a,d,c){zd=!1;mb=Fa;Z(!1);v=c;eh(b,a,d);Hc=!0;qc()};this.newFilenames=function(b){zd=!1;mb=Fa;Z(!1);dh(b);Hc=!0;qc()};this.reloadFOF=function(){ca("reload FoF = "+wc);Be("r");Oc?HAniS.newFOF(vh,!1):(Hc=!0,qc())};this.getFOF=function(){var b=
e.file_of_filenames.trim();HAniS.newFOF(null!=ae?ae+b:b,!0)};this.newFOF=function(b,a){var d,c,g,e,f=new XMLHttpRequest,k,h,l,p,m,n;rg=ib;var q=null;zd=!1;mb=Fa;Z(!1);a&&Aa(Jg);ib=v=0;ta=[];kb=null;lb=0;Ba=Da=null;Zg=[];for(xf=null;hc.hasChildNodes();)hc.removeChild(hc.lastChild);ie=0;Ya=Xc=!1;Za=null;Fd=!1;va=-1;kc=Pb=jc=Ob=null;Yg=-1;pa=[];var r=!1;if(null==fb||null!=qd)fb=[];ca("new FOF="+b);Sa&&(null!=ub&&(J(ub,!0,"extrap on"),F.style.cursor="default",Z(mb),Ha=-1),Sa=!1,G());nb&&(null!=mc&&(J(mc,
!0,"mark on"),F.style.cursor="default",Z(mb),ad=-1),nb=!1,G());f.onload=function(){var a=this.responseText.split("\n");for(d=0;d<a.length;d++)if(!(2>a[d].length)&&(k=a[d].trim(),ca("FOF: "+k),0!=k.indexOf("#")))if(0==k.indexOf("frame_labels"))m=k.split("="),Pa=m[1].split(",");else if(0==k.indexOf("redirect"))for(m=k.split("="),n=m[1].split(","),xf=n[0].trim(),c=1;c<n.length;c++){var b=parseInt(n[c],10)-1;Zg[b]=!0}else if(0==k.indexOf("slice")){m=k.split("=");n=m[1].split(",");Ba=[];for(c=0;c<n.length;c++)Ba[c]=
parseInt(n[c],10);Ba[2]=Ba[2]-Ba[0]+1;Ba[3]=Ba[3]-Ba[1]+1}else if(0==k.indexOf("fof_extension"))m=k.split("="),q=m[1].trim();else if(0==k.indexOf("image_base"))m=k.split("="),ba=m[1].trim();else if(0==k.indexOf("overlay_base"))m=k.split("="),ec=m[1].trim();else if(0==k.indexOf("high_res_basemap")){m=k.split("=");n=m[1].split(",");jc=[];for(c=0;c<n.length;c++)jc[c]=n[c].trim(),null!=ba&&(jc[c]=ba+jc[c]);Fd=!0}else if(0==k.indexOf("high_res_overlay")){m=k.split("=");n=m[1].split(",");Yg=parseInt(n[0].trim(),
10)-1;kc=[];for(c=1;c<n.length;c++)kc[c-1]=n[c].trim(),null!=ec?kc[c-1]=ec+kc[c-1]:null!=ba&&(kc[c-1]=ba+kc[c-1]);Fd=!0}else if(0==k.indexOf("high_res_zoom")){m=k.split("=");n=m[1].split(",");Za=[];for(c=0;c<n.length;c++)Za[c]=parseFloat(n[c].trim());sc()}else if(0==k.indexOf("hoverzone"))Nd(k);else if(0==k.indexOf("hotzone"))Od(k);else if(0==k.indexOf("hotspot"))Nc(k);else if(0==k.indexOf("toggle_onoff"))m=k.split("="),re=m[1].split(",");else if(0==k.indexOf("coordinates"))m=k.split("="),Q(m[1]);
else if(0==k.indexOf("map_scale"))m=k.split("="),n=m[1].split(","),vc=parseFloat(n[0]),Ud=1<n.length?parseFloat(n[1]):vc;else if(0==k.indexOf("times")){m=k.split("=");n=m[1].split(",");for(d=0;d<n.length;d++)fb[d]=parseInt(n[d].trim(),10);r=!0}else{null!=qd&&(b=k.match(qd),null!=b&&2==b.length?(fb.push(parseInt(b[1],10)),ca("+ + + Extrap time = "+b[1]),r=!0):ca("+ + + Cannot parse times using "+qd+" from line: "+k));g=k.indexOf(" ");0>g&&(g=k.length);ta[v]=k.substring(0,g).trim();null!=ba&&(ta[v]=
ba+ta[v]);k=k.substring(g+1);b=k.indexOf('"');0<=b&&(null==Pa&&(Pa=[]),g=k.substring(b+1),b=g.indexOf('"'),0<=b&&(Pa[v]=g.substring(0,b),0==v&&(Ga.innerHTML=Pa[0])));pa[v]=[];b=k.indexOf("overlay");if(0<=b)for(h=k.substring(b),b=h.indexOf("="),0>b&&ca("Cannot find a = sign in "+h),l=h.substring(b+1),h=l.trim(),l=h.split(","),fa=l.length,ca("numOverlays set to "+fa),e=0;e<l.length;e++)pa[v][e]=l[e].trim(),null!=xf&&Zg[e]?pa[v][e]=(xf+pa[v][e]).trim():null!=ec?pa[v][e]=(ec+pa[v][e]).trim():null!=ba&&
(pa[v][e]=(ba+pa[v][e]).trim());v+=1}r&&Ld(fb);null!=q?(a=new XMLHttpRequest,a.onload=function(){var a=this.responseText.split("\n");for(d=0;d<a.length;d++)2>a[d].length||(p=a[d].trim(),ca("ext_FOF: "+p),0!=p.indexOf("#")&&(0==p.indexOf("hotzone")?Od(p):0==p.indexOf("hotspot")&&Nc(p)));Bb()},a.onerror=function(){Bb()},a.open("get",q+"?"+Math.round(1E5*Math.random()),!0),a.send()):Bb()};vh=b;f.open("get",b+"?"+Math.round(1E5*Math.random()),!0);f.send()};this.setWindowSize=function(b,a){if(null!=F){F.style.height=
a+"px";F.style.width=b+"px";F.style.padding="0px";a=a-(null!=bf?bf.offsetHeight:0)-(null!=cf?cf.offsetHeight:0)-(null!=qb?qb.offsetHeight:0)-Ig*(null!=yb?yb.offsetHeight:0);a>Y&&(a=Y);var d=a*ha/Y;d>b&&(d=b,a=b*Y/ha);a=Math.floor(a);d=Math.floor(d);Uc||($a(d,a),G())}};this.drag=function(b){nb||(S=ma.getX(),P=ma.getY(),Qb?(b=r.length-1,r[b].xe=S,r[b].ye=P,r[b].xp.push(S),r[b].yp.push(P),r[b].size=Math.round(Math.sqrt(Math.pow(S-r[b].x,2)+Math.pow(P-r[b].y,2)))):(u=S*t,p=P*w,Jc=tb=!1,Zb&&(!Vd||Vd&&
b.shiftKey)?(Jd=u,Kd=p,Jc=!0):(ra&&L!=se?(C=ka-u/D,y=la-p/L,0>C&&(C=0),y<be&&(y=be),C+Oa>ha&&(C=ha-Oa),y+za>Y-Tc&&(y=Y-Tc-za),C=Math.round(C),y=Math.round(y),ka=Math.round(C+u/D),la=Math.round(y+p/L)):nb||Sa||!Ya||(ja=null,Pc&&0<=u&&0<=p&&(K=wd.getImageData(u,p,1,1).data,0!=K[3]&&(ja=Da[K[3]-1]))),Ae=!0,qa())),G())};this.resetZoom=function(){D=lf;L=se;null!=ua&&(J(ua,!0,"zoom on"),ra=!1);ka=u;la=p;y=C=0;za=Y;Oa=ha;sc();qa();Xc&&(Ya=!0)};this.canTip=function(){var b;tb=!1;S=ma.getX();u=S*t;P=ma.getY();
p=P*w;if(!((nb||Sa)&&p<Qg&&p>Pg&&u>Og)){ka=Math.round(C+u/D);la=Math.round(y+p/L);if(0!=ib)for(b=0;b<ib;b++)if(xa[b].overlay>=fa)ca(" Error...hotzone overlay # "+xa[b].overlay+" > number of overlays = "+fa);else if(B[xa[b].overlay].checked&&(Ia.clearRect(0,0,1,1),Ia.drawImage(A[x][xa[b].overlay],ka,la,1,1,0,0,1,1),K=Ia.getImageData(0,0,1,1).data,zf=(K[0]<<16)+(K[1]<<8)+K[2],zf==xa[b].color)){tb=!0;Rg=S;Sg=P;Tg=xa[b].tip;break}if(0!=lb)for(b=lb-1;0<=b;b--)if(null!=kb[b]){var a=kb[b];if(-1==a.frame||
a.frame==x)if(-1==a.overlay||B[a.overlay].checked){var d=!1;if(a.isPan)if(a.isIcon){var c=(a.x0-C)*D-a.w2;var e=(a.y0-y)*L-a.h2;u>c&&u<c+a.width&&p>e&&p<e+a.height&&(d=!0)}else c=(a.x0-C)*D,e=(a.y0-y)*L,u>c&&u<c+a.width*D&&p>e&&p<e+a.height*L&&(d=!0);else u>a.x0&&u<a.x1&&p>a.y0&&p<a.y1&&(d=!0);if(d&&null!=a.tip){tb=!0;Rg=S;Sg=P;Tg=kb[b].tip;break}}}G()}};this.move=function(){if(!Sa&&Ya&&(ja=null,Pc)){var b=ma.getX()*t,a=ma.getY()*w;0<=b&&0<=a&&(K=wd.getImageData(b,a,1,1).data,0!=K[3]&&(ja=Da[K[3]-
1]))}Sa&&2<=Ha&&(S=ma.getX(),u=S*t,P=ma.getY(),p=P*w);G()};this.down=function(){tb&&(tb=!1,G());S=ma.getX();u=S*t;P=ma.getY();p=P*w;we=u;xe=p;Jd=we;Kd=xe;ka=Math.round(C+u/D);la=Math.round(y+p/L);Ae=!1;if(Qb){var b={};b.x=S;b.y=P;b.xe=S;b.ye=P;b.xp=[S];b.yp=[P];b.type=Dd.value;b.color=Cd.value;b.width=pc.value;b.text=xb.value;b.size=0;r.push(b)}};this.up=function(b){tb=!1;if(!Qb){if(Sa||nb){S=ma.getX();u=S*t;P=ma.getY();p=P*w;if(nb){ad=1;if(0<ad&&p/w<sh){if(u/t>rh){ia.pop();ia.pop();0==ia.length&&
(ad=0);G();return}if(u/t<qh){G();b=window.open("","Mark Points");b.document.write("<div>Marked Points<br>");for(var a=[],d=0;d<ia.length;d+=2)ka=C+ia[d]/D,la=y+ia[d+1]/L,Cb(),b.document.write(Qa[0].toFixed(4)+","+Qa[1].toFixed(4)+"<br>"),0==d&&(a[0]=Qa[0],a[1]=Qa[1]);b.document.write(a[0].toFixed(4)+","+a[1].toFixed(4)+"<br>");return}}ia.push(u);ia.push(p);G();return}if(3>Ha)if(zb[Ha]=u,rb[Ha]=p,dd[Ha]=Xe[x],0==Ha)Ha=1,Aa(oa(v-1)),te=1,Sc=null;else{$g=dd[1]-dd[0];ve=(zb[1]-zb[0])/$g;Id=(rb[1]-rb[0])/
$g;if(null!=Oe&&null!=vc){d=ve*vc;var c=Id*Ud;a=Math.round(60*Math.sqrt(d*d+c*c));d=Math.atan2(d,-c)/.0174533;0>d&&(d+=360);Sc=Xf+Ah[Math.round(d/22.5)]+" at "+a+" "+Yf;oh=zb[0];ph=0<Id?rb[0]-15:rb[0]+30}a=parseInt(nd,10);T=Math.round(Math.abs(4*(a+4)/ve));ed=Math.round(Math.abs(2*(a+4)/Id));ed<T&&(T=ed);120<T?T=120*Math.floor(T/120)+60:90<T?T=120:60<T?T=90:30<T?T=60:15<T?T=30:10<T?T=15:5<T?T=10:2<T?T=5:0==T&&(T=1);ed=dd[1]/T*T+T;Hd=1;Wf&&(Hd=-1);Ng=ve*T;tf=Id*T;Aa(oa(v-1));Ha=3;te=2}else if(p/w<
Qg&&p/w>Pg&&u/t>Og&&3==Ha){Rd();G();return}G()}if(Jc)Jc=!1,G();else if(null!=vb&&ra&&(Zb=!1,J(vb,!0,"distance on")),Ae)Ae=!1;else if(b.altKey)HAniS.resetZoom();else if(Ya&&null!=ja&&sf)tc(ja,"z");else{S=ma.getX();u=S*t;P=ma.getY();p=P*w;if(0!=ib)for(a=0;a<ib;a++)if(xa[a].overlay>=fa)ca(" Error...hotzone overlay # "+xa[a].overlay+" > number of overlays = "+fa);else if(B[xa[a].overlay].checked&&(Ia.clearRect(0,0,1,1),Ia.drawImage(A[x][xa[a].overlay],Math.floor(ka),Math.floor(la),1,1,0,0,1,1),K=Ia.getImageData(0,
0,1,1).data,zf=(K[0]<<16)+(K[1]<<8)+K[2],zf==xa[a].color)){tc(xa[a],"z");return}if(0!=lb)for(a=lb-1;0<=a;a--)if(null!=kb[a]){var e=kb[a];if(!(-1!=e.frame&&e.frame!=x||e.fromfile||-1!=e.overlay&&!B[e.overlay].checked)){var f=!1;e.isPan?e.isIcon?(d=(e.x0-C)*D-e.w2,c=(e.y0-y)*L-e.h2,u>d&&u<d+e.width&&p>c&&p<c+e.height&&(f=!0)):(d=(e.x0-C)*D,c=(e.y0-y)*L,u>d&&u<d+e.width*D&&p>c&&p<c+e.height*L&&(f=!0)):u>e.x0&&u<e.x1&&p>e.y0&&p<e.y1&&(f=!0);if(f){tc(kb[a],"s");return}}}ra&&(Ya=!1,uc(b.ctrlKey||yf));qa();
G()}}};this.wheel=function(b){ra&&(S=ma.getX(),u=S*t,P=ma.getY(),p=P*w,ka=Math.round(C+u/D),la=Math.round(y+p/L),uc(-1==b))};this.toggleAutoRefresh=function(){id?(J(gc,!1,"autorefresh off"),null!=wc&&clearInterval(wc),id=!1):(J(gc,!0,"autorefresh on"),wc=setInterval("HAniS.reloadFOF();",Ge),id=!0)};this.toggleLoopRock=function(){Gd?(J(Yc,!0,"looprock rock"),Gd=!1):(J(Yc,!1,"looprock loop"),Gd=!0)};this.toggleExtrap=function(){Sa?(null!=ub&&(J(ub,!0,"extrap on"),F.style.cursor="default",null!=gb&&
(gb.disabled=!1),Z(mb),ra=gg,Ha=-1),Sa=!1,G()):(null!=ub&&(Sa=!0,Sc=null,F.style.cursor="crosshair",J(ub,!1,"extrap off"),mb=Fa,null!=gb&&(gb.disabled=!0),Fa=!1,gg=ra,ra=!1,HAniS.resetZoom(),Rd(),G()),qa())};this.doEnhance=function(b){if(Wc||yc){var a=Ca[0].height,d=Ca[0].width;b=parseInt(sa.value,10);0<=b?(mf=La[b],nf=Ma[b],of=Na[b],pf=td[b],bc[db]=b):bc[db]=null;var c=a*d*4;for(d=0;d<Nb.length;d++)if(Ca[d].gotit){Ca[d].gotit=!1;var e=he[d].data;var f=Ze[d];if(0>b)for(a=0;a<c;a+=4)e[a]=f[a],e[a+
1]=f[a+1],e[a+2]=f[a+2],e[a+3]=f[a+3];else for(a=0;a<c;a+=4)Ra=f[a],Ra===f[a+1]&&Ra===f[a+2]&&(e[a]=mf[Ra],e[a+1]=nf[Ra],e[a+2]=of[Ra],e[a+3]=pf[Ra]);Ic[d].putImageData(he[d],0,0);Ca[d].gotit=!0}}};this.overClick=function(b){var a;if(b.target.checked)for(a=0;a<B.length;a++)b.target!=B[a]&&0!=b.target.name&&b.target.name==B[a].name&&(B[a].checked=!1);Pc=!0;for(a=0;a<Gb.length;a++)b.target!=B[a]&&ab(a),null!=cc&&!cc[a]&&B[a].checked&&(Pc=!1),null!=sa&&a===db&&(sa.disabled=!B[a].checked);qa()};this.toggleIsLooping=
function(){Fa?(Fa=!1,J(gb,!0,"startstop start")):(Fa=!0,J(gb,!1,"startstop stop"))};this.toggleZooming=function(){ra?(HAniS.resetZoom(),J(ua,!0,"zoom on")):(J(ua,!1,"zoom off"),ra=!0,null!=vb&&(Zb=!1,J(vb,!0,"distance on")),Xc&&(Ya=!0),Sa&&HAniS.toggleExtrap())};this.togclick=function(b){var a=Hg.getX();Hg.getY();for(var d=Lg,c=0;c<Ea.length;c++){if(a>d&&a<d+cd){if(b.shiftKey){0<=Ea[c]&&(Z(!1),Aa(c));break}b=0;0<=Ea[c]&&(b=-1);Ta(c,b);break}d=d+cd+qe}}};